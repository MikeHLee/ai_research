## Weather-Informed Probabilistic Forecasting and Scenario Generation in Power Systems

Hanyu Zhang _[a,b]_ [,][âˆ—], Reza Zandehshahvar _[a,b]_, Mathieu Tanneau _[a,b]_ and Pascal Van Hentenryck _[a,b]_ [,][âˆ—âˆ—]


_a_ _H. Milton Stewart School of Industrial and Systems Engineering, Georgia Institute of Technology, Atlanta, 30332, GA, USA_
_b_ _AI Institute for Advances in Optimization, Atlanta, 30332, GA, USA_



A R T I C L E I N F O


_Keywords_ :
Time Series

Deep Learning
Probabilistic Forecasting
Gaussian Copula
Scenario Generation


**1. Introduction**



A B S T R A C T


The integration of renewable energy sources (RES) into power grids presents significant challenges
due to their intrinsic stochasticity and uncertainty, necessitating the development of new techniques for
reliable and efficient forecasting. This paper proposes a method combining probabilistic forecasting
and Gaussian copula for day-ahead prediction and scenario generation of load, wind, and solar power
in high-dimensional contexts. By incorporating weather covariates and restoring spatio-temporal
correlations, the proposed method enhances the reliability of probabilistic forecasts in RES. Extensive
numerical experiments compare the effectiveness of different time series models, with performance
evaluated using comprehensive metrics on a real-world and high-dimensional dataset from Midcontinent Independent System Operator (MISO). The results highlight the importance of weather
information and demonstrate the efficacy of the Gaussian copula in generating realistic scenarios,
with the proposed weather-informed Temporal Fusion Transformer (WI-TFT) model showing superior
performance.



The adoption of Renewable Energy Sources (RES),
especially wind and solar generation, is at the forefront
of modern power systemsâ€™ transition towards sustainable
and carbon-free electricity generation. This transition also
promises to improve the affordability and accessibility of
energy systems worldwide (U.S. Department of Energy,
n.d.a,n). However, integrating high levels of RES into existing power grids introduces significant challenges, particularly in forecasting. Indeed, RES, whose output depends
on weather conditions, are intrinsically intermittent and
stochastic. This operational uncertainty thus complicates
grid stability and optimization efforts (U.S. Department
of Energy, n.d.a) which, in turn, motivates the need for
advanced forecasting tools.
In that context, academics and practitioners have increasingly moved from deterministic to _probabilistic_ forecasting, which better captures the uncertainty in load and
RES output. In addition, probabilistic forecasts provide the
ability to sample multiple scenarios, which is essential for
risk quantification (Stover, Karve and Mahadevan, 2023) and
uncertainty-aware optimization (Knueven, Faqiry, Garcia,
Chen, Treinen, Werho, Zhang, Vittal, Zhao, Thatte and
Yin, 2023). Despite their popularity, probabilistic forecasts
present substantial scalability challenges. Indeed, they must
capture _spatial_ (between system elements located at different


This research was partly supported by NSF award 2112533 and
ARPA-E PERFORM award AR0001136.

âˆ— Corresponding author
âˆ—âˆ— Principal corresponding author


hanyzhang@gatech.edu (H. Zhang); reza@isye.gatech.edu (R.
Zandehshahvar); mathieu.tanneau@isye.gatech.edu (M. Tanneau);
pascal.vanhentenryck@isye.gatech.edu (P. Van Hentenryck)
ORCID (s): 0000-0002-5903-0883 (H. Zhang); 0000-0002-6249-905X (R.
Zandehshahvar); 0000-0003-1554-8303 (M. Tanneau); 0000-0001-7085-9994
(P. Van Hentenryck)



locations), and _temporal_ (between different time periods)
correlations. Typical forecasting tasks comprise hundreds
of renewable generators and dozens of time steps (e.g. 48
hours), with output dimensions in tens of thousands, and correlation matrices with hundreds of millions of coefficients.
To address these challenges, this paper focuses on the
development of high-dimensional probabilistic forecasting
methods for load and RES generation. By utilizing weather
information as covariates and restoring the spatio-temporal
correlations among the prediction variables, this paper sets
the foundation for reliable scenario generation using highdimensional multivariate time series forecasting in RES.


**1.1. Related Work**

_**1.1.1. Time Series Forecasting**_
Historically, the domain of time series prediction was
dominated by statistical methods, with Autoregressive Integrated Moving Average (ARIMA) (Ho and Xie, 1998)
model being a prominent example. However, these methods often fall short in capturing the non-linear and nonstationary nature of the time series and might not be reliable for forecasting RES. The advent of Recurrent Neural Networks (RNNs) marked a significant shift, demonstrating superior capabilities in capturing complex temporal dependencies inherent in time series data (Sutskever,
Vinyals and Le, 2014; Smyl, 2020). Notably, the sequenceto-sequence (S2S) RNN architecture (Sutskever et al., 2014),
initially developed for neural machine translation, has inspired the development of innovative time series forecasting models such as multi-quantile RNN (Wen, Torkkola,
Narayanaswamy and Madeka, 2017), DeepAR model (Salinas, Flunkert, Gasthaus and Januschowski, 2020), and Temporal Fusion Transformer (TFT) (Lim, ArÄ±k, Loeff and Pfister, 2021). By leveraging cross-series and cross-temporal
learning, these methods have gained promising performance



Hanyu Zhang et al.: _Preprint submitted to Elsevier_ Page 1 of 19


Probabilistic Forecasting and Scenario Generation



across diverse fields, which motivates their utilization for
RES forecasting (Dong, Sheng and Yang, 2018; Wilms,
Cupelli, Monti and Gross, 2019; Srivastava, Vedanshu and
Tripathi, 2020). For a comprehensive survey of the recent
advancements in RNN-based and general deep learning architectures in time series forecasting, readers are referred to
Hewamalage, Bergmeir and Bandara (2021) and Lim and
Zohren (2021).
Despite their significant advancements, RNN-based models and their derivatives encounter substantial challenges in
accurately forecasting the dynamics of modern power systems. These challenges stem largely from the intermittency,
uncertainty, and stochasticity associated with the integration of RES and distributed energy resources into existing
power networks (Shi, Liang and Dinavahi, 2018). Such
complexities highlights the urgent need to pivot from the
deterministic forecasting approaches to uncertainty quantification of forecast errors (Pinson, Nielsen, MÃ¸ller, Madsen
and Kariniotakis, 2007; Bremnes, 2004). Many studies have
adopted parametric approaches to model the distribution
of forecast errors, utilizing distributions such as the beta
distribution (Bludszuweit, Dominguez-Navarro and Llombart, 2008) and the logit-normal distribution (Pinson, 2012).
These approaches, while valuable, often presume a specific
functional form for the forecast errors, which may not always
align with the observed data. In contrast, non-parametric
methods, particularly quantile regression, offer a more flexible solution (Pinson et al., 2007; Wan, Lin, Wang, Song and
Dong, 2017). Quantile regression excels in providing a comprehensive quantification of uncertainty without the need to
assume a predetermined functional form or distribution of
forecast errors. This methodological flexibility is especially
pertinent in addressing the complexities of stochastic power
systems, thereby enhancing decision-making processes in
critical operations such as risk management, unit commitment, economic dispatch, and optimal decision-making
(Holttinen, Milligan, Ela, Menemenlis, Dobschinski, Rawn,
Bessa, Flynn, Gomez-Lazaro and Detlefsen, 2012; Sioshansi
and Hurlbut, 2010). Additionally, there is growing interest in leveraging multivariate time series prediction over
univariate models to better capture output dependencies.
Recent studies, such as Mashlakov, Kuronen, Lensu, Kaarna
and Honkapuro (2021), have adopted multivariate time
series prediction approaches for forecasting load, wind, solar
power, and price within power systems. However, these
studies typically focus on zonal-level forecasting, which
diverges from the generator-level analysis prevalent in most
power flow problems. Furthermore, these approaches often
overlook the correlations between different forecasting dimensions, a critical factor for effective scenario generation.
The integration of weather forecast covariates, which can
significantly influence forecasting accuracy, is also absent in
their model. Another limitation of prior research is its focus
on small-scale datasets and problem settings, which may not
capture the complexity and scalability required for broader
applications. This paper addresses these shortcomings by



employing a combination of the copula method with multivariate forecasting approaches on a large-scale problem.


_**1.1.2. Scenario Generation in RES**_

Scenario generation in power systems is the process of
creating diverse and possible future states of the system, accounting for uncertainties caused by different factors such as
temperature and other weather-related variable fluctuations,
which affects the power consumption and generation within
the RES. Various methods have been proposed for scenario
generation in power systems, including sampling-based approaches (e.g., Monte Carlo sampling, latin hypercube sampling) (Carmona and Yang, 2021; Saraninezhad, Ramezani
and Falaghi, 2022) and optimization-based methods (e.g.,
moment matching, distance matching) (Li, Zhou and Chen,
2020; Liao, Yang, Chen and Li, 2022; Lu, Wu and Wu,
2021). While these methods are foundational, they often require extensive datasets and/or are computationally demanding, particularly for generating high-dimensional scenarios.
Moreover, when these methods are applied to individual
dimensions (i.e., marginal distributions), they struggle to
capture the critical spatio-temporal correlations present in
the system.
Recently, Generative Adversarial Networks (GANs) have
been employed in power systems scenario generation, notably within wind power generation, as demonstrated in
(Zhang, Ai, Xiao, Hao and Lu, 2020; Dong, Chen and Yang,
2022; Tan, Qi, Sun, Li, Yang and Li, 2020). These methods
have been demonstrated to be effective in capturing the
dynamic and complex patterns inherent in RES, thereby
providing a robust framework for simulating realistic and
diverse energy production scenarios. Dong et al. applies a
data-driven GAN model to wind and solar scenario generation, however, weather information was not incorporated
in the model (Dong et al., 2022). Zhang et al. utilized a
point-prediction forecasting model, using GAN to learn the
distribution of forecast errors and generate scenarios by
adding generated residuals to the point forecasts, making
the modelâ€™s performance highly dependent on the accuracy
of the initial forecasts (Zhang et al., 2020). Chen et al. also
applied GANs to generate solar and wind scenarios, with a
model that can condition on certain weather events, however
does not include the weather time series such as wind speed
and solar irradiation and can result in low performance
(Chen, Wang, Kirschen and Zhang, 2018). Furthermore,
training GANs presents significant challenges, especially
when dealing with the high-dimensional forecasting problems in RES.

The integration of the copula method with time series forecasting presents a promising solution to the aforementioned challenges by facilitating the modeling of the
joint distribution. For example, the DeepVAR model utilizes a Gaussian copula to model the time-varying mutualdependence structure, incorporating a low-rank structure on
the Gaussian copula covariance to enhance computational
efficiency (Salinas, Bohlke-Schneider, Callot, Medico and
Gasthaus, 2019). However, DeepVAR assumes stationarity



Hanyu Zhang et al.: _Preprint submitted to Elsevier_ Page 2 of 19


Probabilistic Forecasting and Scenario Generation



in the time series, an assumption often violated in the context
of RES. An alternative strategy involves using copula methods as a post-processing step to combine predicted marginal
distributions, where the covariance matrix of the Gaussian
copula captures temporal dependencies (Golestaneh, Gooi
and Pinson, 2016). The application of copulas effectively
bridges the gap between probabilistic forecasting models and
the generation of realistic spatio-temporal scenarios. Gaussian copulas, in particular, have been extensively explored in
the realm of wind power scenario generation, employing an
exponential covariance function to address situations with
limited historical observations (Ma, Sun and Fang, 2013;
Bessa, 2016). Additionally, recursive methods have been
employed in wind power forecasting to refine scenario generation processes (Pinson, Madsen, Nielsen, Papaefthymiou
and KlÃ¶ckl, 2009).


**2. Contributions**


To address the existing gaps within high-dimensional
forecasting in RES, this paper introduces a comprehensive
probabilistic multivariate time series forecasting framework
that leverages Gaussian copulas for enhanced forecasting
and realistic scenario generation of load, and wind and solar
power generation. The proposed model is augmented with
both historical and forthcoming weather forecast covariates,
aiming at improving forecasting and scenario generation performance across various temporal and spatial dimensions.
The principal contributions of this paper are threefold:


  - Integration of multivariate time series forecasting with
copula method for high-dimensional problem in RES
to effectively capture the complex spatial and temporal
dependencies. Particularly, the largest problem is a 48hour ahead prediction for 376 solar farms, with an
output dimension of 10,848.


  - Showcasing the importance of incorporating weather
forecast data, which significantly enhances the accuracy and reliability of forecasting and scenario generation processes, especially for higher prediction lead
times.


  - Comprehensive benchmarking and comparison of various time series prediction methodologies, including
ARIMA, DeepAR, NLinear, DLinear, and TFT, combined with Gaussian copula. Different metrics are
considered to evaluate the efficacy of these models
in multi-dimensional forecasting and scenario generation within power systems.


The analysis encompasses time series forecasting methods for the prediction and scenario generation of load, and
wind and solar power generation within the Midcontinent
Independent System Operator (MISO) system. In contrast
with previous methods, which are mainly on small and/or
low-dimensional datasets, this work considers probabilistic
forecasting of a large-scale system with 6 load zones, 286



wind farms and 376 solar farms. The proposed WeatherInformed (WI) TFT model is highlighted for its superior
performance across multiple evaluation metrics, in both deterministic forecasting and scenario generation. The findings
of this paper showcase the comparative effectiveness of
different forecasting techniques within the context of energy
forecasting and uncertainty quantification, thus providing
critical insights for risk-aware decision making in power
system operations.


**3. Problem Formulation**


This section outlines the problem formulation and introduces the notations used for the probabilistic multivariate
time series forecasting of load, and wind and solar power
generation, that incorporates weather data.


**3.1. Problem Setting**
Let _ğ‘_ _ğ‘–,ğ‘¡_ denote a random variable corresponding to the
target _ğ‘–_ âˆˆ îˆ° = {1 _, .., ğ·_ } (i.e., a load, a wind farm, or a solar
farm) at time _ğ‘¡_ âˆˆ â„¤, and denote its realization as _ğ‘§_ _ğ‘–,ğ‘¡_ âˆˆ â„.
The vector realization of all joint observations at time _ğ‘¡_ is
defined as:


**ğ³** _.,ğ‘¡_ = ( _ğ‘§_ 1 _,ğ‘¡_ _, ..., ğ‘§_ _ğ·,ğ‘¡_ ) âˆˆ â„ _[ğ·]_ (1)


For instance, in the context of wind farms, _ğ‘§_ _ğ‘–,ğ‘¡_ represents
the output generated power of wind farm _ğ‘–_ at time _ğ‘¡_, measured in megawatts (MW), and **ğ³** _.,_ **ğ­** is the vector representing
output of all wind farms at time _ğ‘¡_ . Similarly, for an individual
target _ğ‘–_, the realization of the univariate time series for time
interval î‰€ = { _ğ‘¡_ + 1 _, ..., ğ‘¡_ + _ğ‘‡_ } _âŠ†_ â„¤ is denoted by:


**ğ³** _ğ‘–,_ î‰€ = ( _ğ‘§_ _ğ‘–,ğ‘¡_ +1 _, ..., ğ‘§_ _ğ‘–,ğ‘¡_ + _ğ‘‡_ ) âˆˆ â„ _[ğ‘‡]_ (2)


Hence, the multivariate time series realization corresponding to the targets in the system from time _ğ‘¡_ + 1 to _ğ‘¡_ + _ğ‘‡_ is
denoted as:



The details corresponding to each target and the covariates
are discussed in Section 6.



**ğ³** â‹… _,_ î‰€ = â›âœâ€” **ğ³** 1 _,ğ‘¡_ +1âˆ¶ â‹® _ğ‘¡_ + _ğ‘‡_ â€”
âœââ€” **ğ³** _ğ·,ğ‘¡_ +1âˆ¶ _ğ‘¡_ + _ğ‘‡_ â€”



â
âŸ âˆˆ â„ _[ğ·]_ [Ã—] _[ğ‘‡]_ (3)
âŸâ 



The paper also considers so-called _covariates_, denoted by
**ğ±** _.,ğ‘¡_ with support in â„ _[ğ·]_ [â€²] . Thereby, for _ğ‘—_ âˆˆ îˆ° [â€²] = {1 _, ..., ğ·_ [â€²] },
_ğ‘¥_ _ğ‘—,ğ‘¡_ represents the observed value of the _ğ‘—_ -th covariate at
time _ğ‘¡_, and the vector representation of all covariates at time
_ğ‘¡_ is denoted by **ğ±** _.,ğ‘¡_ = ( _ğ‘¥_ 1 _,ğ‘¡_ _, ..., ğ‘¥_ _ğ·_ â€² _,ğ‘¡_ ). The corresponding
covariates in the paper include time encoding, e.g., day of
the week, and the weather-related quantities such as temperature, humidity, cloud coverage, wind speed, etc. Hence, the
matrix realization of the covariates is denoted as below:



**ğ±** â‹… _,_ î‰€ = â›âœâ€” **ğ±** 1 _,ğ‘¡_ +1âˆ¶ â‹® _ğ‘¡_ + _ğ‘‡_ â€”
âœââ€” **ğ±** _ğ·_ â€² _,ğ‘¡_ +1âˆ¶ _ğ‘¡_ + _ğ‘‡_ â€”



â
âŸ âˆˆ â„ _[ğ·]_ [â€²] [Ã—] _[ğ‘‡]_ (4)
âŸâ 



Hanyu Zhang et al.: _Preprint submitted to Elsevier_ Page 3 of 19


()) )))











Estimated
Marginals












  - ğ‘¹ ["] : Estimated








|Col1|Uniform Marginals|Col3|Col4|
|---|---|---|---|
||ğ’°|ğ’°||
|||||
||||ğ’°|
|||||
|||||
|||||
|||||



(b)





Correlation Matrix

                                    - ğ¹ [$] ! ! |ğ‘¿ : Estimated

Marginals

                                    - ğ‘† : Number of

ğ’° ğ’© Scenarios


























|ğ’°|Col2|Col3|Col4|Col5|
|---|---|---|---|---|
|||||ğ’°|
||||||
||||||
||||||
||||||


|ğ’©|Col2|Col3|Col4|
|---|---|---|---|
|ğ’©||||
|ğ’©||||
|ğ’©||||
|ğ’©||||



(c)


**Figure 1:** Schematic of the proposed method for scenario generation in RES. (a) Schematic of the weather informed multivariate
probabilistic forecasting for wind farms, given the historical wind power generation and the past and future weather covariates.
(b) Schematic of estimating the Gaussian copula for a 2D example. (c) Schematic of the scenario generation steps given the
estimated copula and estimated marginals for a 2D problem. Examples of generated scenarios using marginals are also presented
in (c) with red triangles.



**4. Multivariate Forecasting**


Let _ğ‘¡_ âˆˆ â„¤ and consider the forecasting horizon îˆ´ =
{ _ğ‘¡_ + 1 _, ..., ğ‘¡_ + _ğ»_ } of length _ğ»_, and the past observation
window of length _ğ‘Š_ as î‰ƒ = { _ğ‘¡_ âˆ’ _ğ‘Š_ +1 _, .., ğ‘¡_ âˆ’1 _, ğ‘¡_ }. A time
series forecasting model predicts the target **ğ³** _.,_ îˆ´ âˆˆ â„ _[ğ·]_ [Ã—] _[ğ»]_ as
**Ì‚ğ³** _.,_ îˆ´ âˆˆ â„ _[ğ·]_ [Ã—] _[ğ»]_ . Figure 1(a) shows schematic of the DL-based
model for multivariate probabilistic forecasting of the wind



power generation given historical data and covariates. More
generally, probabilistic forecasting can be considered as
modeling the joint cumulative distribution function (CDF)
of the target variables conditioned on the past observations
**ğ³** _.,_ î‰ƒ âˆˆ â„ _[ğ·]_ [Ã—] _[ğ‘Š]_, past covariates **ğ±** _.,_ î‰ƒ âˆˆ â„ _[ğ·]_ [â€²] [Ã—] _[ğ‘Š]_, and the future
covariates **ğ±** _.,_ îˆ´ âˆˆ â„ _[ğ·]_ [â€²] [Ã—] _[ğ»]_ as


**ğ…** îˆ´ ( **z** _.,_ îˆ´ ) = â„™ [(] **ğ™** _.,_ îˆ´ â‰¤ **ğ³** _.,_ îˆ´ [|] | **ğ³** _.,_ î‰ƒ _,_ **ğ±** _.,_ î‰ƒ _,_ **ğ±** _.,_ îˆ´ ) (5)



Hanyu Zhang et al.: _Preprint submitted to Elsevier_ Page 4 of 19


Probabilistic Forecasting and Scenario Generation



**Table 1**

Nomenclature


**Sets**
îˆ° Set of target variables (i.e., load zones, wind
farms, or solar farms)
îˆ° [â€²] Set of covariates

î‰€ Time window

îˆ´ Forecasting horizon time window
î‰ƒ Past observation time window
Î© Dataset of input-output pairs

**Indices**

_ğ‘–_ âˆˆ îˆ° Spatial index
_ğ‘¡_ âˆˆ â„¤ Time index of forecast start times
_ğœ_ âˆˆ îˆ´ Time index representing a specific time step
within the forecast horizon


**Variables**
_ğ‘_ _ğ‘–,ğ‘¡_ Random variable for target at location _ğ‘–_ and
time _ğ‘¡_
_ğ‘§_ _ğ‘–,ğ‘¡_ Realization of the random variable _ğ‘_ _ğ‘–,ğ‘¡_
**ğ³** _.,ğ‘¡_ Vector realization of all joint observations in
locations within îˆ° at time _ğ‘¡_
**ğ³** _ğ‘–,_ î‰€ Vector realization of observations at location
_ğ‘–_ within time interval î‰€
**ğ™** _.,_ î‰€ Matrix of random variables for target locations within îˆ° over time horizon î‰€
**ğ³** _.,_ î‰€ intervalMatrix of all observations in î‰€ (i.e., realization of **ğ™** îˆ° _.,_ î‰€ )over time
**ğ±** _.,ğ‘¡_ Vector realization of all joint covariates
within îˆ° [â€²] at time _ğ‘¡_
**ğ±** _.,_ î‰€ Matrix of all covariates ininterval î‰€ îˆ° [â€²] within time
_ğ‘_ _ğ‘–_ _, ğ‘§_ _ğ‘–_ Random variable and realization in target
space with CDF _ğ¹_ _ğ‘_ _ğ‘–_
_ğ‘ˆ_ _ğ‘–_ _, ğ‘¢_ _ğ‘–_ Random variable and realization in uniform
space î‰ [0 _,_ 1]
_ğ‘‰_ _ğ‘–_ _, ğ‘£_ _ğ‘–_ Random variable and realization in Gaussian
space îˆº (0 _,_ 1)
_ğ¹_ _ğ‘–,ğœ_ ( _ğ‘§_ _ğ‘–,ğœ_ ) Marginal CDF for target at location _ğ‘–_ âˆˆ îˆ°
at time _ğœ_ âˆˆ îˆ´
**ğ…** _.,_ îˆ´ ( **ğ³** _.,_ îˆ´ ) Joint CDF for all targets withintime window îˆ´ îˆ° over
_Ì‚ğ¹, Ì‚_ **ğ…** Empirical marginal and joint CDFs
**ğŸ** _,_ **ğŸ** Vectors of all zeros and ones, respectively
**ğ‘** Correlation matrix
**ğ‚** Copula function
Î¦ Standard normal CDF
**ğš½** **ğ‘** Multivariate normal CDF with standard normal marginal CDFs and correlation matrix **ğ‘**

**Operators**

vec Matrix vectorization

max Largest value operator


Modeling this joint CDF directly is challenging due to the
high-dimensionality of the problems at hand. An alternative,
in the multivariate forecasting setting, is to jointly predict the
following marginal distributions:


_ğ¹_ _ğ‘–,ğœ_ ( _ğ‘§_ _ğ‘–,ğœ_ ) = â„™( _ğ‘_ _ğ‘–,ğœ_ â‰¤ _ğ‘§_ _ğ‘–,ğœ_ âˆ£ **ğ³** _.,_ î‰ƒ _,_ **ğ±** _.,_ î‰ƒ _,_ **ğ±** _.,_ îˆ´ ) _,_ (6)



where _ğ‘–_ âˆˆ îˆ° is the spatial index indicating the location of the
target and _ğœ_ âˆˆ îˆ´ represents the time index within the forecasting horizon. In other words, the multivariate forecasting
model takes as input the historical data and covariates, which
are shared across different targets, and predicts the marginal
distributions. Then, given the estimated marginals as the
outputs of the multivariate forecasting, the next critical step
is to restore the spatial and temporal correlations among
the target variables. This is necessary for realistic scenario
generation, particularly within the RES where the targets
(e.g., electricity demand and outputs of multiple wind farms
or solar farms at different locations and time horizons) are
highly correlated. This paper restores the joint distribution
of the random variable **ğ™** _.,_ îˆ´ using a copula method, as
discussed in Section 5.


**5. Restoring Correlations via Copula**


The copula method provides a robust statistical tool
for modeling the underlying dependencies and correlations
in high-dimensional probabilistic forecasting. This method
enables the estimation of the joint distribution by combining
the marginal distributions with a copula function. In the context of RES, the copula method facilitates the generation of
realistic scenarios that accurately reflect the true variability
and spatial-temporal interdependencies.


**5.1. Copula Method**
A function **ğ‚** âˆ¶[0 _,_ 1] _[ğ‘‘]_ â†’ [0 _,_ 1] is a _copula_ if it
is the joint CDF of a _ğ‘‘_ -dimensional random vector **ğ”** =
( _ğ‘ˆ_ 1 _,_ â€¦ _, ğ‘ˆ_ _ğ‘‘_ ) with uniformly distributed marginals on the
interval [0 _,_ 1]. Sklarâ€™s Theorem (Sklar, 1959) shows that
any multivariate CDF can be expressed as the product of its
marginal distributions and a copula function.


**Theorem 1** (Sklarâ€™s Theorem ) **.** _Let_ **ğ™** _be a ğ‘‘-dimensional_
_random variable with joint CDF_ **ğ…** **ğ™** _and marginal CDFs_
_ğ¹_ _ğ‘_ 1 _,_ â€¦ _, ğ¹_ _ğ‘_ _ğ‘‘_ _. There exists a copula_ **ğ‚** _such that_


**ğ…** **ğ™** ( _ğ‘§_ 1 _, ..., ğ‘§_ _ğ‘‘_ ) = **ğ‚** ( _ğ¹_ _ğ‘_ 1 ( _ğ‘§_ 1 ) _, ..., ğ¹_ _ğ‘_ _ğ‘‘_ ( _ğ‘§_ _ğ‘‘_ )) _,_ (7)


_and the random variables ğ‘ˆ_ _ğ‘–_ = _ğ¹_ _ğ‘_ _ğ‘–_ ( _ğ‘_ _ğ‘–_ ) _are uniformly_
_distributed on interval_ [0 _,_ 1] _(i.e., ğ‘ˆ_ _ğ‘–_ âˆ¼ î‰ [0 _,_ 1] _). The copula_
**ğ‚** _is unique, given continuous marginals ğ¹_ _ğ‘_ 1 _,_ â€¦ _, ğ¹_ _ğ‘_ _ğ‘‘_ _._


Sklarâ€™s theorem thus enables the decomposition of any
multivariate CDF into its marginal CDFs and a copula,
without specific assumptions on the marginals. Hence, given
the estimated marginal CDFs, it is possible, via a Copula
function, to reconstruct the joint CDF and represent the
underlying dependencies and correlations among different
dimensions. This is particularly crucial in probabilistic forecasting in RES where spatial and temporal correlations
should be restored in high dimensions.


**5.2. Conditional Copula**
Sklarâ€™s theorem can be extended to modeling conditional
distributions, which is particularly important in regression



Hanyu Zhang et al.: _Preprint submitted to Elsevier_ Page 5 of 19


Probabilistic Forecasting and Scenario Generation



and time series forecasting (Patton, 2006, 2009). Given a
target random vector **ğ™** = ( _ğ‘_ 1 _,_ â€¦ _, ğ‘_ _ğ‘‘_ ) conditioned on a set
of input variables **ğ—**, the conditional copula aims at modeling
**ğ…** **ğ™** | **ğ—** from its marginals _ğ¹_ _ğ‘_ 1 | **ğ—** _,_ â€¦ _, ğ¹_ _ğ‘_ _ğ‘‘_ | **ğ—** as follows:


**ğ…** **ğ™** | **ğ—** = **ğ‚** ( _ğ¹_ _ğ‘_ 1 | **ğ—** ( _ğ‘§_ 1 | **ğ±** ) _,_ â€¦ _, ğ¹_ _ğ‘_ _ğ‘‘_ | **ğ—** ( _ğ‘§_ _ğ‘‘_ | **ğ±** )) (8)


It is important to note that, in general, the input variables **ğ—**
should be consistent across different marginals and the copula. For further details and considerations regarding different
input variable sets under specific assumptions, readers are
referred to (Fermanian and Wegkamp, 2012).


**5.3. Gaussian Copula**
One of the most popular and effective ways of linking
the joint distribution into its marginals is the Gaussian
copula. Considering Î¦ as the CDF of the standard normal
distribution and **ğš½** **ğ‘** as the multivariate normal CDF with
mean vector of **ğŸ** and covariance matrix of **ğ‘**, the Gaussian
copula **ğ‚** **ğ‘** âˆ¶[0 _,_ 1] _[ğ‘‘]_ â†’ [0 _,_ 1] is defined as:


**ğ‚** **ğ‘** = **ğš½** **ğ‘** (Î¦ âˆ’1 ( _ğ‘¢_ 1 ) _,_ â€¦ _,_ Î¦ âˆ’1 ( _ğ‘¢_ _ğ‘‘_ )) (9)


As a result, the multivariate joint CDF **ğ…** **ğ™** | **ğ—** can be decomposed as:


**ğ…** **ğ™** | **ğ—** =

**ğš½** **ğ‘** (Î¦ [âˆ’1] [(] _ğ¹_ _ğ‘_ 1 | **ğ—** ( _ğ‘§_ 1 | **ğ±** ) [)] _,_ â€¦ _,_ Î¦ [âˆ’1] [(] _ğ¹_ _ğ‘_ _ğ‘‘_ | **ğ—** ( _ğ‘§_ _ğ‘‘_ | **ğ±** ) [))]

(10)


The two main pillars to estimate the joint CDF under the
Gaussian copula framework are: 1) the marginal CDFs _ğ¹_ _ğ‘_ _ğ‘–_ | **ğ—**
for _ğ‘–_ âˆˆ{1 _,_ â€¦ _, ğ‘‘_ } and 2) the correlation matrix **ğ‘** âˆˆ â„ _[ğ‘‘]_ [Ã—] _[ğ‘‘]_,
which is responsible for modeling the correlations among
different dimensions.
Figure 1(b) shows the schematic of the approach for
estimating the Gaussian copula for a 2D (i.e., _ğ‘‘_ = 2)
problem. First, the marginal CDFs are estimated as _ğ¹_ _[Ì‚]_ _ğ‘_ _ğ‘–_ | **ğ—**
using a probabilistic forecasting model and a training dataset
Î© train with _ğ‘_ = |Î© train | samples. Then, given the training
covariate and target pairs (i.e., ( **ğ±** [(] _[ğ‘›]_ [)] _,_ **ğ³** [(] _[ğ‘›]_ [)] ) âˆˆÎ© train _, ğ‘›_ âˆˆ
{1 _,_ â€¦ _, ğ‘_ }), and the estimated marginals _ğ¹_ _[Ì‚]_ _ğ‘_ _ğ‘–_ | **ğ—**, each of the

target dimensions _ğ‘§_ [(] _ğ‘–_ _[ğ‘›]_ [)] is transformed into _ğ‘¢_ [(] _ğ‘–_ _[ğ‘›]_ [)] = _Ì‚ğ¹_ _ğ‘_ _ğ‘–_ | **ğ—** .

The transformed variables _ğ‘¢_ [(] _ğ‘–_ _[ğ‘›]_ [)] are distributed uniformly on

[0 _,_ 1] if the underlying model that estimates marginals is
well-calibrated (refer to the probability integral transform
in the Appendix for more details). Following this step, the
corresponding data is transformed through the inverse of
the standard normal CDF to _ğ‘£_ [(] _ğ‘–_ _[ğ‘›]_ [)] = Î¦ [âˆ’1] ( _ğ‘¢_ [(] _ğ‘–_ _[ğ‘›]_ [)] [)][. This results]
in a space with standard normal marginal CDFs. Finally,
the correlation matrix is estimated as **ğ‘** **[Ì‚]**, using Pearson
correlation over **ğ¯** [(] _[ğ‘›]_ [)] = ( _ğ‘£_ [(] 1 _[ğ‘›]_ [)] _[,]_ [ â€¦] _[, ğ‘£]_ [(] _ğ‘‘_ _[ğ‘›]_ [)] [)] _[, ğ‘›]_ [âˆˆ{1] _[,]_ [ â€¦] _[, ğ‘]_ [}][.]
The estimated correlation matrix is then used along with
the estimated marginals to form the Gaussian copula as
presented in Equation (10). In short, given a dataset with
dimension _ğ‘‘_ Ã— _ğ‘_, where _ğ‘‘_ corresponds to the dimension



**5.4. Scenario Generation**

The combination of the multivariate probabilistic forecasting and copula method provides the estimated joint
distribution of the target variables, incorporating the correlations among different dimensions. Consequently, it is possible to generate probabilistic scenarios by sampling from
the estimated joint distribution that captures the underlying
correlations between different dimensions.
The scenario generation steps are outlined in Algorithm
1 and are depicted in Figure 1(c) for a 2D (i.e., _ğ‘‘_ = 2) example. The algorithm takes as input the estimated correlation
matrix **ğ‘** **[Ì‚]**, the estimated marginals _ğ¹_ _[Ì‚]_ _ğ‘_ _ğ‘–_ | **ğ—** for _ğ‘–_ âˆˆ{1 _,_ â€¦ _, ğ‘‘_ },
and the number of required scenarios (i.e., the number of
samples from the joint distribution) _ğ‘†_, and it outputs **Ì‚ğ³** [(] _[ğ‘ ]_ [)] =
( _Ì‚ğ‘§_ [(] 1 _[ğ‘ ]_ [)] _[,]_ [ â€¦] _[, Ì‚ğ‘§]_ _ğ‘‘_ [(] _[ğ‘ ]_ [)] [)][ for] _[ ğ‘ ]_ [âˆˆ{1] _[, ..., ğ‘†]_ [}][. The algorithm starts by]

sampling **ğ¯** [(] _[ğ‘ ]_ [)] = ( _ğ‘£_ [(] 1 _[ğ‘ ]_ [)] _[,]_ [ â€¦] _[, ğ‘£]_ _ğ‘‘_ [(] _[ğ‘ ]_ [)] [)][ from a multivariate normal]
distribution with **ğŸ** mean and estimated covariance matrix
**Ì‚ğ‘** (i.e., îˆ¹î‰‚îˆº ( **ğŸ** _,_ **Ì‚ğ‘** )). The samples are then transformed
using the CDF of the standard normal into _ğ‘¢_ [(] _ğ‘–_ _[ğ‘ ]_ [)] = Î¦( _ğ‘£_ [(] _ğ‘–_ _[ğ‘ ]_ [)] [)][,]
which has uniform marginals (as shown in Figure 1(c)).
Finally, the samples are mapped into the original space via
_Ì‚ğ‘§_ [(] _[ğ‘ ]_ [)] = _Ì‚ğ¹_ [âˆ’1]
_ğ‘–_ _ğ‘_ _ğ‘–_ | **ğ—** [(] _[ğ‘¢]_ _ğ‘–_ [(] _[ğ‘ ]_ [)] [)][. The resulting vector] **[ Ì‚ğ³]** [(] _[ğ‘ ]_ [)] [ corresponds]
to the samples generated using the copula method, which
captures the interdependencies and correlations among the
different dimensions.


**5.5. Copula for Time Series Scenario Generation**
This section extends the Gaussian copula method to
the context of time series forecasting in RES, where the
objective is to model a joint CDF for all sites and time steps,
and generate scenarios that capture both spatial and temporal
dependencies across the forecasting horizon. In this setting,
the joint conditional CDF **ğ…** îˆ´ ( **ğ³** _.,_ îˆ´ ) is over _ğ‘‘_ = _ğ·_ Ã— _ğ»_



**Algorithm 1** Scenario Generation Pseudo-code


**Inputs:** **ğ‘** **[Ì‚]** (Estimated Correlation Matrix),

_Ì‚ğ¹_ _ğ‘_ _ğ‘–_ | **ğ—** (Estimated Marginals for _ğ‘–_ âˆˆ{1 _,_ â€¦ _, ğ‘‘_ }),
_ğ‘†_ (Total Number of Required Scenarios)
**Output:** Generated Scenarios: **Ì‚ğ³** [(] _[ğ‘ ]_ [)] = ( _Ì‚ğ‘§_ [(] 1 _[ğ‘ ]_ [)] _[,]_ [ â€¦] _[, Ì‚ğ‘§]_ _ğ‘‘_ [(] _[ğ‘ ]_ [)] [)][ for]
_ğ‘ _ âˆˆ{1 _,_ â€¦ _, ğ‘†_ }
**for** _ğ‘ _ = 1 to _ğ‘†_ **do** _âŠ³_ Can be done in parallel
Sample **ğ¯** [(] _[ğ‘ ]_ [)] = ( _ğ‘£_ [(] 1 _[ğ‘ ]_ [)] _[,]_ [ â€¦] _[, ğ‘£]_ _ğ‘‘_ [(] _[ğ‘ ]_ [)] [)][ from][ îˆ¹î‰‚îˆº] [(] **[ğŸ]** _[,]_ **[ Ì‚ğ‘]** [)]
**for** each _ğ‘–_ âˆˆ{1 _,_ â€¦ _, ğ‘‘_ } **do**

Compute _ğ‘¢_ [(] _ğ‘–_ _[ğ‘ ]_ [)] = Î¦( _ğ‘£_ [(] _ğ‘–_ _[ğ‘ ]_ [)] [)]
Map to the original space:

_Ì‚ğ‘§_ [(] _[ğ‘ ]_ [)] = _ğ¹_ _[Ì‚]_ [âˆ’1]
_ğ‘–_ _ğ‘_ _ğ‘–_ | **ğ—** [(] _[ğ‘¢]_ _ğ‘–_ [(] _[ğ‘ ]_ [)] [)]
**end for**

**end for**


of the copula and _ğ‘_ is the number of training data points,
i.e., _ğ‘_ = |Î© _ğ‘¡ğ‘Ÿğ‘ğ‘–ğ‘›_ |, the correlation matrix is estimated as:



â¤
â¥
â¥
â¥â¦ _ğ‘‘_ Ã— _ğ‘_



â
âŸ
âŸ
âŸâ 



â€” Î¦ [âˆ’1] [ (] _Ì‚ğ¹_ _ğ‘§_ 1 âˆ£ **ğ±** ( _ğ‘§_ [(] 1 _[ğ‘›]_ [)] âˆ£ **ğ±** [(] _[ğ‘›]_ [)] [))] â€”

â‹®

â€” Î¦ [âˆ’1] [ (] _Ì‚ğ¹_ _ğ‘§_ _ğ‘‘_ âˆ£ **ğ±** ( _ğ‘§_ [(] _ğ‘‘_ _[ğ‘›]_ [)] âˆ£ **ğ±** [(] _[ğ‘›]_ [)] [))] â€”



_Ì‚_
**ğ‘** = corr



â›â¡
âœâ¢
âœâ¢
âœââ¢â£



(11)



Hanyu Zhang et al.: _Preprint submitted to Elsevier_ Page 6 of 19


Probabilistic Forecasting and Scenario Generation



dimensions (recall that _ğ·_ = |îˆ°| is the number of locations
and _ğ»_ = |îˆ´| is the number of time steps in the forecast
horizon). Similar to what is presented in Section 5.3, the
joint conditional CDF can be derived from: 1) the estimated
conditional marginals _ğ¹_ _[Ì‚]_ _ğ‘–,ğœ_ ( _ğ‘§_ _ğ‘–,ğœ_ ) (where _ğ‘–_ âˆˆ îˆ° and _ğœ_ âˆˆ
îˆ´) and 2) a Gaussian copula with an estimated correlation
matrix **ğ‘** **[Ì‚]** âˆˆ â„ [(] _[ğ·]_ [Ã—] _[ğ»]_ [)Ã—(] _[ğ·]_ [Ã—] _[ğ»]_ [)] that captures the spatio-temporal
correlations as follows:


**Ì‚ğ…** îˆ´ ( **ğ³** _.,_ îˆ´ ) = **ğš½** **Ì‚ğ‘** (Î¦ [âˆ’1] [(] _[ Ì‚]_ _ğ¹_ 1 _,ğ‘¡_ +1 ( _ğ‘§_ 1 _,ğ‘¡_ +1 ) [)] _,_ â€¦ _,_ Î¦ [âˆ’1] [(] _ğ¹_ _[ Ì‚]_ 1 _,ğ‘¡_ + _ğ»_ ( _ğ‘§_ 1 _,ğ‘¡_ + _ğ»_ ) [)] _,_


â€¦ _,_ (12)

Î¦ [âˆ’1] [(] _ğ¹_ _[ Ì‚]_ _ğ·,ğ‘¡_ +1 ( _ğ‘§_ _ğ·,ğ‘¡_ +1 ) [)] â€¦ _,_ Î¦ [âˆ’1] [(] _ğ¹_ _[ Ì‚]_ _ğ·,ğ‘¡_ + _ğ»_ ( _ğ‘§_ _ğ·,ğ‘¡_ + _ğ»_ ) [))]


Note that **ğ…** **[Ì‚]** îˆ´ and _ğ¹_ _[Ì‚]_ _ğ‘–,ğœ_ (defined in (5) and (6), respectively)
are conditioned on the inputs **ğ³** _.,_ î‰ƒ, **ğ±** _.,_ î‰ƒ, and **ğ±** _.,_ îˆ´, which are
omitted in Equation (12) for simplicity. Also, _ğœ_ depends on
_ğ‘¡_, which corresponds to the starting of the forecasting time
window. The marginals are estimated using multivariate
probabilistic time series forecasting given a training dataset
and the corresponding covariates as:



_ğ‘¡_ âˆˆ{ _ğ‘Š, ğ‘Š_ + 1 _,_


â€¦ _, ğ‘_ âˆ’ _ğ»_ } _,_



â«
âª
âª
â¬
âª
âªâ­



Î© train =



â§
âª
âª
â¨
âª
âªâ©



({ **ğ³** _.,_ [(] _[ğ‘¡]_ î‰ƒ [)] _[,]_ **[ ğ±]** _.,_ [(] _[ğ‘¡]_ î‰ƒ [)] _[,]_ **[ ğ±]** _.,_ [(] _[ğ‘¡]_ îˆ´ [)] [}] _[,]_ **[ ğ³]** _.,_ [(] _[ğ‘¡]_ îˆ´ [)] )
||||||||||



îˆ´ ={ _ğ‘¡_ + 1 _,_ â€¦ _, ğ‘¡_ + _ğ»_ } _,_


î‰ƒ ={ _ğ‘¡_ âˆ’ _ğ‘Š_ + 1 _,_ â€¦ _, ğ‘¡_ }



_,_



where _ğ‘_ is the total length of the training time series dataset
and _ğ‘¡_ is the time index in the rolling time window.
Next, using the estimated marginal CDFs and following
the steps outlined in Section 5.3, the correlation matrix **ğ‘** _[Ì‚]_ âˆˆ
â„ [(] _[ğ·]_ [Ã—] _[ğ»]_ [)Ã—(] _[ğ·]_ [Ã—] _[ğ»]_ [)] can be estimated using Pearson correlation,
with _ğ‘_ [â€²] = _ğ‘_ âˆ’ _ğ‘Š_ âˆ’ _ğ»_ +1 samples (i.e., the training dataset
excluding the few first and last time steps).
The scenario generation follows the process outlined
in Section 5.4 and Algorithm 1. Samples are drawn from
îˆ¹î‰‚îˆº ( **ğŸ** _,_ **ğ‘** _[Ì‚]_ ), producing _ğ‘†_ vectors with dimensions 1Ã—( _ğ·_ Ã—
_ğ»_ ). Each sample is then reshaped into a matrix of size _ğ·_ Ã— _ğ»_,
where the rows and the columns correspond to locations and
time, respectively.


**6. Experiment Setup**


A comprehensive performance evaluation was conducted
with large-scale data using various time series forecasting
methods. Both deterministic and probabilistic forecasting
methods are employed to assess their efficacy under different
metrics. Additionally, the experiments incorporate weather
information to evaluate its importance in predicting RES.
The forecast horizon îˆ´ is set to 48 hours, which aligns with
the common practice for day-ahead market-clearing and reliability assessment in power systems (Werho, Zhang, Vittal,
Chen, Thatte and Zhao, 2021). However, the methodology
can be extended to longer or shorter time horizons depending
on the specific requirements.



**Table 2**

Dataset Summary: This table presents the overall minimum
and maximum values across all time series. For wind and

solar, the maximum values represent the capacity of the largest
wind or solar farms. For the load time series, which does
not have a predefined capacity, the capacity is defined by the
highest observation in the training dataset. The minimum value
for each type corresponds to the lowest recorded observation
across all time series.


Type _ğ·_ Level Total(GW) Min (MW) Max (MW)
load 6 zone 124.2 9424.6 32148.5

wind 286 unit 21.4 0.6 495.0

solar 376 unit 1.8 0.2 138.0


**6.1. Dataset**

Table 2 provides summary statistics of the MISO dataset
that is used in this study which contains time series data
for the years 2018 and 2019 with hourly resolution within
the MISO system (Sergi, Feng, Zhang, Hodge, Ring-Jarvi,
Bryce, Doubleday, Rose, Buster and Rossol, 2022). This
dataset includes zone-level time series for loads and unit
level time series of wind and solar power generation. Additionally, it includes forecasts generated by NRELâ€™s System
Advisor Model (SAM) for the year 2019, which is considered for comparison with the developed models in this study.
To explore the effect of weather data, this study incorporates an additional dataset of weather forecasts for the
MISO system. The weather forecasts are gathered from the
publicly available datasets produced by the European Center
for Medium-Range Weather Forecasts (ECMWF), particularly from the THORPEX Interactive Grand Global Ensemble (TIGGE) dataset (European Centre for Medium-Range
Weather Forecasts, 2023; Varela Santolalla and Mladek,
2024). This dataset provides essential meteorological variables including surface pressure, wind speed, cloud cover,
skin temperature, solar irradiation, as outlined in Table 3.
Issued twice everyday at 12:00 and 00:00 UTC, the forecasts
from the TIGGE database are provided in 6-hour intervals
(Varela Santolalla and Mladek, 2024). The forecast data is
collected on a 1Â° latitude by 1Â° longitude grid covering the
MISO territory. The 6-hour temporal resolution time series
from the ECMWF are then interpolated to hourly granularity
to align with the load, and wind and solar power time series
data used in this study.


**6.2. Methods**
In this study, different methods are employed to determine their efficacy for 48-hour forecasting horizon prediction in RES and load. The models encompass both traditional
statistical methods and advanced DL-based techniques with
and without incorporation of weather data, to provide a comprehensive performance comparison. The models include:


  - ARIMA: This model is implemented in a univariate
framework due to the shortcoming of the autoregresive methods in handling high-dimensional input data
(Ho and Xie, 1998).



Hanyu Zhang et al.: _Preprint submitted to Elsevier_ Page 7 of 19


Probabilistic Forecasting and Scenario Generation


**Table 3**
Description of Meteorological Variables (Varela Santolalla and Mladek, 2024).


Variable Description
10u - Eastward component of the 10 metre wind ( _U-component_ ): Measures the horizontal speed of air moving towards
the east at a height of ten metres above the Earthâ€™s surface, in metres per second.
10v - Northward component of the 10 metre wind ( _V-component_ ): Measures the horizontal speed of air moving towards
the north at a height of ten metres above the Earthâ€™s surface, in metres per second.
2t  - 2 metre temperature: Temperature of the air measured at 2 metres above the surface of the Earth, in kelvins (K).
skt  - Skin temperature: Temperature at the interface between the Earth and the atmosphere, in kelvins (K). Measured
directly at the Earthâ€™s surface.
sp - Surface pressure: Atmospheric pressure exerted on the Earthâ€™s surface by the air above, measured in pascals (Pa).
Reflects the weight of the air vertically above a point.
ssr  - Net surface solar radiation: Total solar radiation (shortwave radiation) reaching a horizontal plane at the Earthâ€™s
surface, adjusted for the albedo, measured in joules per square metre (J/m [2] ).
tcc  - Total cloud cover: Proportion of the sky occluded by clouds, measured on a scale from 0 (no cover) to 1 (complete
cover).




  - Dlinear: This is a linear model tailored for time series

forecasting. The implementation in this work considers the spatio-temporal correlations by regressing the
forecasts over the previous observations and past and
future covariates (Zeng, Chen, Zhang and Xu, 2022).


  - Nlinear: This model normalizes each input by subtracting the last value in the sequence and then adds it
back after passing through the linear layer to address
distribution shift. In this paper, the model is adapted
to probabilistic setting by using quantile regression
objective function (Zeng et al., 2022).


  - DeepAR: This is an RNN-based model designed to
capture the temporal dependencies and provide multistep ahead forecast by recursively applying the model,
using its own predictions as inputs for subsequent
steps. In this work, the modelâ€™s output parameters
are parametrized using a Beta distribution to account
for the capacity factors in RES, which are inherently
bounded between 0 and 1 (Salinas et al., 2020).


  - TFT: This is a transformer-based model designed for
multi-horizon forecasting with mixed-type inputs, including static covariates, known future inputs, and
past exogenous time series. Quantile loss is utilized
for training the model in this work (Lim et al., 2021).


The models are trained using historical data of the targets
from 2018 within the MISO system, with the remaining data
reserved for testing. At the beginning of each month, a new
model is trained using all available observations since Jan.
1st, 2018 up to midnight on the first day of that month.
The first week of each month is designated for validation
purposes (i.e., for fine tuning the model parameters), and the
models are subsequently evaluated during the second week
of each month. The DL models are trained both with and

without weather data to assess the importance of weather
covariates. Evaluations are conducted only for the first nine
months, as the ECMWF data was not available from October

2019 onward.



Weather features are utilized as additional covariates

in the forecasting tasks for the WI-based models. These
covariates include both historical weather data and weather

forecasts, which are available in advance as discussed in the
previous section. For each target variable, weather information from the closest region on a 1Â° by 1Â° grid is used. For
load forecasting, skin temperature and total cloud cover are
incorporated as key variables. For wind power generation
forecasting, the model uses wind speed, surface pressure,
and both V and U wind components, which indicate horizontal airflow towards the north and east, respectively. In
forecasting solar power generation, total cloud cover and
surface solar radiation are key variables. When generating
forecasts, the actual weather information from the past and
weather forecasts for the upcoming forecasting horizon are
fed into the WI-based models..

The ARIMA model parameters are optimized using the
open-source Statsforecasts package (NIXTLA, 2024), which
features an AutoARIMA function for parameter selection.
Training of the DL-based models are performed in Pytorch
using Adam optimizer (Kingma and Ba, 2014). Early stopping with patience of 10 steps in conjunction with a learning
rate scheduler (ReduceLROnPlateau) with patience of 5
steps is used for all models. The remaining hyperparameters
for each model are optimized using Optuna (Akiba, Sano,
Yanase, Ohta and Koyama, 2019). The details about the
training process are provided in C.


**6.3. Evaluation Metrics**

This section outlines various metrics employed to quantify the models for both deterministic and the probabilistic
forecasting (i.e., scenario generation). Recall that, for a given
target _ğ‘–_ âˆˆ îˆ° and each time step within the forecasting time
horizon ( _ğœ_ âˆˆ îˆ´), the model produces output in the form
of marginal CDFs, whereas _ğ‘†_ forecasts (i.e., scenarios) are
generated for the scenario generation using Algorithm 1.
This essentially gives the prediction one more dimension,
which indiced by superscript ( _ğ‘ _ ).
The evaluation of the deterministic forecasts are performed at the individual and space-sum levels. Additionally,



Hanyu Zhang et al.: _Preprint submitted to Elsevier_ Page 8 of 19


Probabilistic Forecasting and Scenario Generation


**Table 4**
Summary and Description of Evaluation Metrics. âˆ— ED _Ì‚_ ( **ğ±** _,_ **ğ²** ) = _ğ‘†_ [2] âˆ‘ _ğ‘†ğ‘–_ =1 [â€–] **[ğ±]** _[ğ‘–]_ [âˆ’] **[ğ²]** [â€–][ âˆ’] _ğ‘†_ 1 [2] âˆ‘ _ğ‘†ğ‘–_ =1 âˆ‘ _ğ‘†ğ‘—_ =1 [â€–] _[ğ‘¥]_ _[ğ‘–]_ [âˆ’] _[ğ‘¥]_ _[ğ‘—]_ [â€–] _[,]_ [ more details in appendix.]

âˆ—âˆ— max{ **ğ³** _ğ‘–,_ î‰€ train } refers to the capacity for wind/solar farm _ğ‘–_, which is the maximum observation in the training dataset for time series _ğ‘–_ .


Metric Formula Description



Computed on individual space-time dimensions, normalized
by generator capacity or maximum value in the first year of
training dataset, measuring modelâ€™s accuracy relative to the
scale of the time series.


Computed on the summation over space, measuring modelâ€™s
accuracy relative to the scale of the time series.



NMAE [âˆ—âˆ—] 1
ind
_ğ‘_ test _ğ·ğ‘‡_


NMAE s-sum 1

_ğ‘_ test _ğ‘‡_



_ğ‘_ test
âˆ‘

_ğ‘¡_ =1


_ğ‘_ test
âˆ‘

_ğ‘¡_ =1



âˆ‘

_ğœ_ âˆˆîˆ´



||||



âˆ‘

_ğ‘–_ âˆˆîˆ° _,ğœ_ âˆˆîˆ´



_Ì‚ğ‘§_ _ğ‘–,ğœ_ âˆ’ _ğ‘§_ _ğ‘–,ğœ_
max{ **ğ³** _ğ‘–,_ î‰€train } ||||



_ğ·_
âˆ‘



_ğ‘§_ _ğ‘–,ğœ_
_ğ‘–_ =1



~~|~~
|||||
|



_ğ·_ _ğ·_
âˆ‘ _Ì‚ğ‘§_ _ğ‘–,ğœ_ âˆ’ âˆ‘

_ğ‘–_ =1 _ğ‘–_ =1



_ğ·_

_ğ‘–_ âˆ‘ =1 max{ **ğ³** _ğ‘–,_ î‰€train }



_ğ·_
âˆ‘



~~|~~
|||||
|



_ğ‘_ test
âˆ‘

_ğ‘¡_ =1


âˆ‘

_ğœ_ âˆˆîˆ´



Root Mean Squared Error computed on individual level over
( _Ì‚ğ‘§_ _ğ‘–,ğœ_ âˆ’ _ğ‘§_ _ğ‘–,ğœ_ ) 2 all space and time dimensions, measuring modelâ€™s accuracyin MW scale.



RMSE ind


RMSE s-sum



1

_ğ‘_ test _ğ‘‡_

~~âˆš~~



1

_ğ‘_ test _ğ·ğ‘‡_

~~âˆš~~



_ğ‘_ test
âˆ‘

_ğ‘¡_ =1



âˆ‘

_ğ‘–_ âˆˆîˆ° _,ğœ_ âˆˆîˆ´



âˆ‘ _ğ·ğ‘–_ =1 _[Ì‚ğ‘§]_ _[ğ‘–,ğœ]_ [âˆ’]
~~(~~



2 Root Mean Squared Error computed on the summation of
wind power, solar power, or load over space, measuring
~~)~~ modelâ€™s accuracy in MW scale.



_ğ·_
âˆ‘ _ğ‘§_ _ğ‘–,ğœ_

_ğ‘–_ =1



Average energy distance between the actual and probabilistic forecasts, capturing the joint distribution over space and
time.



ED [âˆ—] 1
ind
_ğ‘_ test



_ğ‘ğ‘¡_ âˆ‘ =1 test ED _Ì‚_ ({vec( _Ì‚ğ‘§_ â‹… _,_ îˆ´ ) [(] _[ğ‘ ]_ [)] _, ğ‘ _ âˆˆ îˆ¿} _,_ vec( _ğ‘§_ â‹… _,_ îˆ´ ))



ED [âˆ—] 1
s-sum
_ğ‘_ test



_ğ‘ğ‘¡_ âˆ‘ = test 1 ED _Ì‚_ ({ _Ì‚ğ‘§_ [(] â‹… _,_ _[ğ‘ ]_ îˆ´ [)] _[, ğ‘ ]_ [âˆˆ] [îˆ¿][)}] _[,]_ **[ ğŸ]** [T] _[ğ‘§]_ [â‹…] _[,]_ [îˆ´] [)] Energy distance computed on space-sum level, capturing thejoint distribution over time on the space-sum level.



1

2



âˆ‘

_ğœ_ 2 âˆˆîˆ´



_ğ‘§_ _ğ‘–,ğœ_ 1 âˆ’
_ğ‘–_ =1



âˆ‘ _Ì‚ğ‘§_ [(] _ğ‘–_ 1 _[ğ‘ ]_ [)] _,ğœ_ [âˆ’] [âˆ‘]

_ğœ_ âˆˆîˆ´ _ğœ_ âˆˆîˆ´



~~â›~~
âœ

|||||

âœâ



||||| _ğ‘–_



_ğ·_
âˆ‘



_ğ·_
âˆ‘ _ğ‘§_ _ğ‘–,ğœ_ 2

_ğ‘–_ =1 |||||



VS s-sum


VS t-sum



1

_ğ‘_ test


âˆ’ [1]


_ğ‘†_


1

_ğ‘_ test


âˆ’ [1]


_ğ‘†_



_ğ‘_ test
âˆ‘

_ğ‘¡_ =1



_ğ‘_ test
âˆ‘

_ğ‘¡_ =1



âˆ‘

_ğœ_ 1 âˆˆîˆ´



âˆ‘

_ğ‘–_ 1 âˆˆîˆ°



_ğ‘†_
âˆ‘

_ğ‘ _ =1



|||||



âˆ‘ _Ì‚ğ‘§_ [(] _ğ‘–,ğœ_ _[ğ‘ ]_ [)] 1 [âˆ’]

_ğ‘–_ =1



_ğ·_
âˆ‘



_ğ·_

_ğ‘–_ âˆ‘ =1 _Ì‚ğ‘§_ [(] _ğ‘–,ğœ_ _[ğ‘ ]_ [)] 2



_ğ·_
âˆ‘



|||||



1
2 [â]
âŸ
âŸ
â 



Evaluated for summation of load and renewable generation
predictions over space, capturing temporal correlations.


Evaluated for summation over time periods, capturing
spatial correlations.


are calculated for the load, wind power, and solar power
generation over unseen test data across the different models
discussed in Section 6.2, with and without the inclusion of

the weather covariates.
To evaluate the efficacy of the models and the significance of integrating the copula method for realistic scenario
generation, the results report the energy distance (ED) and
variogram score (VS). ED is a proper scoring rule that measures the distance between the predicted CDF and the actual
observations. It generalizes the continuous ranked probability score (CRPS) and is particularly useful for vector-valued
forecasts in high-dimensional spaces (Gneiting and Raftery,
2007). This paper considers ED due to its generalization
capabilities for high-dimensional data. However, in scenario
generation, both ED and CRPS fail to detect differences
in correlation structures (BjerregÃ¥rd, MÃ¸ller and Madsen,
2021). Therefore, VS is introduced to quantify differences
between the correlations of the scenarios and the ground
truth. More details regarding the metrics are presented in A
in the Appendix.



1

2



âˆ‘

_ğ‘–_ 2 âˆˆîˆ°



âˆ‘ _ğ‘§_ _ğ‘–_ 1 _,ğœ_ âˆ’ [âˆ‘]

_ğœ_ âˆˆîˆ´ _ğœ_ âˆˆ



~~â›~~
âœ

|||||

âœâ



||||| _ğœ_



âˆ‘




[âˆ‘] _ğ‘§_ _ğ‘–_ 2 _,ğœ_

_ğœ_ âˆˆîˆ´ |||||



_ğ‘†_
âˆ‘

_ğ‘ _ =1



|||||



1
2 [â]
âŸ
âŸ
â 



âˆ‘




[âˆ‘] _Ì‚ğ‘§_ [(] _ğ‘–_ 2 _[ğ‘ ]_ [)] _,ğœ_

_ğœ_ âˆˆîˆ´ |||||



the probabilistic forecasts metrics are computed over timesum levels to quantify the ability of the models in capturing
temporal dependencies. Let **ğŸ** be the column vector of all
ones (with proper dimension), the comparison will be:


  - individual ( ind ) level â€” directly comparing the forecast vectors _Ì‚_ **ğ³** [(] _[ğ‘ ]_ [)]
_ğ‘–,ğœ_ _[, ğ‘ ]_ [âˆˆ{1] _[, ..., ğ‘†]_ [}][ and the ground truth]
**ğ³** _ğ‘–,ğœ_ ;


  - space-sum ( s-sum ) level â€” comparison after summation over all locations, i.e., comparing **ğŸ** [T] **ğ³** _Ì‚_ â‹… [(] _,_ _[ğ‘ ]_ îˆ´ [)] [with]
**ğŸ** [T] **ğ³** â‹… _,_ îˆ´ ;


  - time-sum ( t-sum ) level â€” comparison after summation over all time steps, i.e., comparing _Ì‚_ **ğ³** â‹… [(] _,_ _[ğ‘ ]_ îˆ´ [)] **[ğŸ]** [with]
**ğ³** â‹… _,_ îˆ´ **ğŸ** .


Table 4 outlines the metrics used to evaluate deterministic

and probabilistic forecasts. The precision of the deterministic forecasts is evaluated using normalized absolute error
(NMAE) and root mean squared error (RMSE) over the
individual forecasts and space-sum levels. These metrics



Hanyu Zhang et al.: _Preprint submitted to Elsevier_ Page 9 of 19


Probabilistic Forecasting and Scenario Generation


**Table 5**
Deterministic Forecast Evaluation. Performance of different models are evaluated on MISO dataset with and without inclusion of
the weather covariates. The metrics are calculated at individual (i.e., ind ) and space-sum (i.e., s-sum ) levels.


load wind solar


s-sum ind s-sum ind s-sum ind


Model NMAE RMSE NMAE RMSE NMAE RMSE NMAE RMSE NMAE RMSE NMAE RMSE


ARIMA 4.2% 6316.1 5.2% 1302.4 16.6% 4136.8 28.5% 25.4 9.0% 190.3 12.4% 0.7

Dlinear 2.8% 4211.2 4.2% 1003.1 16.7% 4134.2 26.9% 24.6 7.2% 181.0 10.0% 0.7

Nlinear 3.3% 4964.5 3.9% 994.9 16.2% 4030.6 26.0% 23.9 7.4% 182.5 10.2% 0.7
DeepAR 5.1% 7261.4 6.1% 1428.8 16.8% 4357.0 27.2% 25.3 5.2% 168.9 8.2% 0.7
TFT 2.9% 4473.8 3.7% 954.5 16.7% 4335.3 27.0% 25.7 5.5% 173.3 8.9% 0.7


WI-Dlinear 2.7% 4149.3 3.8% 947.3 9.6% 2615.7 18.5% 18.5 4.8% 130.2 7.3% 0.6

WI-Nlinear 3.0% 4572.3 3.9% 984.6 9.7% 2633.1 18.4% 18.4 5.0% 134.9 7.5% 0.6
WI-DeepAR 1.6% 2461.2 2.3% 596.4 10.3% 2778.3 18.7% 19.4 4.0% 139.7 6.3% 0.6
WI-TFT **1.1%** **1702.6** **1.9%** **500.4** **7.9%** **2152.1** **16.1** % **17.0** **3.1%** **106.1** **5.8** % **0.5**


(a) (b) (c)

|)|Col2|Col3|
|---|---|---|
||||
||||
||||
||||
||||
||||


|)|Col2|
|---|---|
|||
|||
|||
|||
|||
|||
|||
|||
|||


f


f


f


f


f


f


f


f


f



**Figure 2:** Total-level forecasting error (i.e., MAE) in MW versus lead time for the time series models for (a) load, (b) wind power
generation, and (c) solar power generatio ~~n.~~


f



f



**7. Results**

f



This section presents the experimental results for the

f

deterministic and probabilistic forecasti ~~ng of the load, and~~
the wind and solar power generation wit ~~hin MISO. Initially,~~

f

the deterministic forecasting results fo ~~r diferent models~~ f

f

discussed in Section 6.2 are presented t ~~o compare the per-~~

|us lead time fo|r the time s|Col3|
|---|---|---|
||||
||||
||||
|~~and RM~~<br>~~across al~~|~~Ein~~<br>~~l ind~~|~~d to~~<br>~~vidual~~|
|~~e~~<br><br><br>RMSEs-|sum are use|sum are use|
|and solar|and wind p|and wind p|
|~~,~~<br><br>sum leve<br>|l.<br>|l.<br>|
|~~Tabl~~<br>|~~ 5 presents~~<br>|~~ 5 presents~~<br>|

formance with and without the inclusion of weather data.

f



Following this, the probabilistic forecasting results are discussed, highlighting the rational for incorporating the copula
technique to restore the correlations. The experimental results are reported on distinct individual and aggregate levels.


**7.1. Deterministic Prediction**
To evaluate the performance of the different models discussed in Section 6.2 for point-predictions and quantify the
importance of weather covariates, deterministic forecasts are
performed for each model. For each probabilistic forecasting
method, and given the predicted marginal distributions of
each space-time dimension, the expected values on each
dimension are used as deterministic forecasts. For models

that trained with quantile loss, the middle quantiles are used
as deterministic forecasts, as they are optimized for L1 loss
(Koenker and Hallock, 2001; Wen et al., 2017). The forecasting accuracy of each model is evaluated using NMAE ind



~~and RMSE~~ ~~ind~~ ~~to measure~~ the average forecast accuracy
~~across all individual series.~~ Additionally, NMAE s-sum and
RMSE s-sum are used to assess the forecasts for total load,
and solar and wind power generation at the aggregate space

f

~~Table 5~~ ~~presents the fore~~ cast errors for MISO system on
the test dataset. The performance of models with and without

f


weather forecast information is compared to examine the im
f


pact of weather covariates. The models that utilize weather
data are denoted with the prefix _WI_ (i.e., weather informed)
in Table 5.

The comparison of deterministic forecasting methods
shows how the DL-based models improve over the traditional ARIMA model. These improvements are primarily
attributed to the transition from ARIMAâ€™s univariate frame
work to a DL-based multivariate approach, which more
accurately captures the complex dynamics within energy
systems. The capacity of these models to effectively utilize cross-series information significantly enriches the forecasting process, offering a deeper understanding of energy
patterns. The integration of weather forecast information
into these models further enhances their accuracy. It is
observed that WI models consistently outperform those that
do not include weather data, highlighting the importance of
weather covariates in predicting the variability of RES. This



f



f


Hanyu Zhang et al.: _Preprint submitted to Elsevier_ Page 10 of 19


Probabilistic Forecasting and Scenario Generation


**Table 6**
Probabilistic Forecast Evaluation. Performance of the weather-informed (WI) models are evaluated on MISO dataset with and
without inclusion of copula (i.e., mar. and cop., respectively) method for scenario generation. The metrics are calculated at
space-sum (i.e., s-sum ), time-sum (i.e., t-sum ), and total levels. Lower values are better.


ED s-sum VS s-sum VS t-sum ED


Target Model mar. cop. mar. cop. mar. cop. mar. cop.


Load WI-DeepAR 25632.1 23882.4 655547.1 629964.7 27518.5 **26209.7** 15834.4 15791.6
WI-Dlinear 46952.4 43919.8 1253299.7 1222333.8 65596.7 63073.6 27159.3 27086.2

WI-Nlinear 50969.3 46696.5 1452783.1 1406618.6 63242.8 60534.6 27566.3 27528.2

WI-TFT 17928.8 **17553.7** 343455.7 **341995.2** 31011.6 30331.8 14299.4 **14277.0**


Wind WI-DeepAR 29751.4 28845.1 1150740.6 1124880.2 7657926.0 7551511.4 5061.9 5036.3
WI-Dlinear 32004.6 26113.7 1329397.4 1152174.8 5038233.2 4877483.1 4571.7 4574.6

WI-Nlinear 32098.8 26033.3 1346814.8 1160315.4 4956035.6 4800996.2 4522.9 4526.2

WI-TFT 25695.3 **24469.8** 1062437.8 **1028368.5** 4396148.6 **4268520.6** **4452.2** 4455.5


Solar WI-DeepAR 1509.4 1389.2 39688.5 39176.7 274696.7 275591.4 278.4 280.6
WI-Dlinear 1598.7 1275.8 51144.3 49122.6 235188.6 **229894.0** 266.0 265.5

WI-Nlinear 1657.9 1319.3 57429.9 54939.6 236787.0 230477.4 270.5 269.7

WI-TFT 1231.4 **1145.9** 27296.2 **26915.7** 259657.2 253595.5 263.9 **263.4**



is most pronounced in the TFT model, where incorporating
weather covariates yields a significant reduction in prediction error by 49% for load forecasting, 40% for wind energy
prediction, and 34% for solar energy prediction on NMAE
at an individual asset level. Similarly, adding covariantes
improves RMSE at individual asset level by 30% to 50%.
Moreover, the advantage of incorporating weather features becomes increasingly apparent for forecasts that extend
further into the future, as depicted in Figure 2. This trend is
especially notable in wind energy forecasting: while models
exhibit comparable accuracy for the initial 5-hour period,
the performance of WI models remains robust beyond this
window. In contrast, models lacking weather data experience
a significant decline in performance over time. This pattern
suggests that short-term predictions primarily rely on the
current state of the system, whereas the accuracy of extended
forecasts is increasingly contingent upon reliable weather information. A notable limitation of the linear models, such as
DLinear and NLinear, is their inability to cope with the daily
seasonality present in the data, which presents as a periodic
pattern in the errors for load and solar power forecasting, as
shown in Figure 2. Conversely, the WI-TFT model maintains
consistent performance across different targets and various
lead times, highlighting its superiority in reliable forecasting
for RES.

The NREL dataset also comes with predictions (Sergi
et al., 2022). Therefore, a comparison of prediction accuracy is made between the results of this paper and NREL.
Every effort has been made to ensure a fair comparison.
However, it should be noted that NREL forecasts have an
11-hour lead time and are updated once a day. In contrast,
the forecasts in this paper are updated hourly without a
lead time. This difference means that Table 5 contains 24
times more samples than the NREL forecasts. In the realm
of load prediction, NREL forecasts exhibit a NMAE of
2.3% and a RMSE of 3708.0 at the aggregate level, and a
NMAE of 3.3% alongside a RMSE of 885.6 at the individual



level. The WI-TFT model for load prediction demonstrates
a notable 52% improvement in NMAE at the aggregate level
and a 4.4% improvement at the individual level over NREL
predictions. When evaluating wind power predictions, the
WI-TFT and NREL models show comparable performance
at the individual level, with NREL registering a RMSE of
16.9. However, at the aggregate level, the WI-TFT model
achieves a 44% better NMAE than the 11.4%from NREL.

For solar power predictions, the WI-TFT model performs
70% worse at the individual level and 94% worse at the

aggregate level in terms of NMAE compared to NREL.
Despite this, both models exhibit high accuracy regarding
the magnitude of errors, as evidenced in Table 5, with the
WI-TFT model averaging only a 0.5 MW error per generator
based on RMSE at individual level.


**7.2. Scenario Generation**

This section presents the results for the probabilistic
forecasting of RES using the DL-based WI models discussed in the previous sections. Models that do not include
weather covariates are omitted, as it was demonstrated that
they consistently underperform compared to the WI models.
Specifically, the performance of the generated scenarios
for load, wind power, and solar power generation using
different models are compared with and without integration
of Gaussian copula. The evaluation metrics are computed for
scenarios generated from both marginal distributions (mar.)
and joint distributions represented by copula (cop.). For each
model and individual target, 200 scenarios are generated
(i.e., _ğ‘†_ = 200) with and without the copula restoration.
The performance of the models for generating scenarios are
presented in Table 6.
The ED quantifies the distance between the distributions of the forecasted scenarios and the actual data. Lower

ED values with the copula indicate improved alignment
of generated scenarios with the true distribution. The ED
for joint distribution and ( s-sum )-level are calculated and



Hanyu Zhang et al.: _Preprint submitted to Elsevier_ Page 11 of 19


Probabilistic Forecasting and Scenario Generation


Actual Forecast Scenarios



|Scenarios 2019-01-10 2019-01-11|Col2|Col3|Col4|Col5|Col6|
|---|---|---|---|---|---|
|||||||
|||||||
|||||||
|||||||
|:00<br>00:00<br>06:00<br>12:00<br>18:00<br>00:00<br>06:00<br>12:00<br>Time|:00<br>00:00<br>06:00<br>12:00<br>18:00<br>00:00<br>06:00<br>12:00<br>Time|:00<br>00:00<br>06:00<br>12:00<br>18:00<br>00:00<br>06:00<br>12:00<br>Time|:00<br>00:00<br>06:00<br>12:00<br>18:00<br>00:00<br>06:00<br>12:00<br>Time|:00<br>00:00<br>06:00<br>12:00<br>18:00<br>00:00<br>06:00<br>12:00<br>Time|:00<br>00:00<br>06:00<br>12:00<br>18:00<br>00:00<br>06:00<br>12:00<br>Time|


|(e) 2019-01-10 2019-01-11|Col2|Col3|Col4|Col5|Col6|
|---|---|---|---|---|---|
|||||||
|||||||
|||||||
|||||||
|||||||
|||||||
|00<br>00:00<br>06:00<br>12:00<br>18:00<br>00:00<br>06:00<br>12:00<br>Time|00<br>00:00<br>06:00<br>12:00<br>18:00<br>00:00<br>06:00<br>12:00<br>Time|00<br>00:00<br>06:00<br>12:00<br>18:00<br>00:00<br>06:00<br>12:00<br>Time|00<br>00:00<br>06:00<br>12:00<br>18:00<br>00:00<br>06:00<br>12:00<br>Time|00<br>00:00<br>06:00<br>12:00<br>18:00<br>00:00<br>06:00<br>12:00<br>Time|00<br>00:00<br>06:00<br>12:00<br>18:00<br>00:00<br>06:00<br>12:00<br>Time|


(f)


(g)


(h)





|Actual 019-01-10 2019-01-11|Col2|Col3|Col4|
|---|---|---|---|
|||||
|||||
|||||
|||||
|00:00<br>06:00<br>12:00<br>18:00<br>00:00<br>06:00<br>12:00<br>Time|00:00<br>06:00<br>12:00<br>18:00<br>00:00<br>06:00<br>12:00<br>Time|00:00<br>06:00<br>12:00<br>18:00<br>00:00<br>06:00<br>12:00<br>Time|00:00<br>06:00<br>12:00<br>18:00<br>00:00<br>06:00<br>12:00<br>Time|


|(a) 019-01-10 2019-01-11|Col2|Col3|Col4|
|---|---|---|---|
|||||
|||||
|||||
|||||
|||||
|||||
|00:00<br>06:00<br>12:00<br>18:00<br>00:00<br>06:00<br>12:00<br>Time|00:00<br>06:00<br>12:00<br>18:00<br>00:00<br>06:00<br>12:00<br>Time|00:00<br>06:00<br>12:00<br>18:00<br>00:00<br>06:00<br>12:00<br>Time|00:00<br>06:00<br>12:00<br>18:00<br>00:00<br>06:00<br>12:00<br>Time|


(b)


(c)


(d)





**Figure 3:** Comparison of Marginal and Copula Scenarios. Generated scenarios for a load (LRZ1) using (a) marginals (i.e., no
inclusion of copula) and (e) with the proposed copula method. (b) The ramps corresponding to the actuals and generated scenarios
from marginals in (a). (f) The ramps for the actuals and generated scenarios using copula from (e). (c, d) The generated scenarios
and the ramps for at total aggregated level using marginals and (g, h) using the proposed copula method.



presented in Table 6. Notably, as the sample sizes remain
constant and the dimension tends to infinity, ED can only
identify the equality of means and the traces of covariance
matrices (Chakraborty and Zhang, 2021). This accounts for
the absence of differences in ED in Table 6, since the copula



does not affect the means and variances of the marginal distribution. Comparing the ED s-sum with and without inclusion
of the copula (i.e., cop. versus mar., respectively) shows that
the copula model is better at capturing the joint distribution
of the overall demand for the load and the overall wind and



Hanyu Zhang et al.: _Preprint submitted to Elsevier_ Page 12 of 19


Probabilistic Forecasting and Scenario Generation


(a) (b) (c)


Actual Forecast Scenarios


**Figure 4:** WI-TFT + Copula for Scenario Generation. Examples of the forecast and 5 generated scenarios for (a) load, (b) wind,
and (c) solar power generation. For simplicity, only 5 scenarios are plotted for each case.



solar power generation with an improvement from 2% to
20% across different models.
The VS evaluates the correlation structure within the

forecast scenarios. Due to the computational expense of
VS for large dimensions, VS s-sum and VS t-sum are computed
to capture the correlations across the spatial and temporal
dimensions, respectively. The VS values are reduced by
0 _._ 4% to 5% upon integration of the copula, demonstrating its
ability in improving the spatial and temporal correlations.
The WI-TFT model performs the best overall due to
its superior ED and sufficiently low VS values. The lower
ED indicates that the scenarios generated by WI-TFT are
more accurate and closer to the true distribution, which is
crucial for effective forecasting and decision making. It is
important to note that VS does not capture the accuracy
of the prediction and ED is more critical than VS in this
context. Hence, ED and VS should be considered together
for a comprehensive assessment of both the accuracy and
reliability of the generated scenarios.
Figure 3 illustrates the comparative scenario analysis
confirmed by the statistical data in Table 6. The left side
of each plot displays various characteristics of scenarios
generated from marginal distributions, while the right side
depicts these characteristics after incorporating estimated
correlations via the copula method. At the top of the figure,
the plots 3a and 3e provide a 48-hour prediction for one load
zone at the individual ( ind )-level. The coverage of the scenarios remains consistent before and after the application of
the copula. However, the copula-generated scenarios exhibit
smoother temporal correlations, aligning more closely with
the ground truth. This smoother correlation is particularly
evident in the Figures 3b and 3f, which shows the ramp rates
of these scenarios. Here, the ramps of the copula models
closely match the actual ramps, whereas those derived from
marginal distributions show significant deviations.
Figures 3g, 3c, 3d, and 3h illustrate the same instance but
at the space-sum ( s-sum )-level. Initially, the copula scenarios
display wider coverage compared to the marginal scenarios, effectively capturing some essential spatial correlations.
This enhanced coverage ensures that the copula scenarios
more accurately encompass the actual total-level outputs.
Similar to the ( ind )-level, the temporal correlations at the
( s-sum )-level are more accurately represented in the copula



scenarios, as demonstrated by the improved ramp alignment
in the final row of the figure.
The conclusions drawn from the load scenarios apply
similarly to wind and solar. Figure 4 shows the effectiveness
of WI-TFT with copula in generating realistic scenarios for
individual load zones, wind farms, and solar farms. The
copula method improves temporal and spatial correlations,
better aligning the generated scenarios with the actual data
compared to marginal distributions alone.


**8. Conclusion**


This paper proposed a new method based on combination of TFT and Gaussian copula for high-dimensional probabilistic forecasting in RES. Extensive experiments were
conducted to compare different time series forecasting methods on a real-world forecasting problem within the MISO
system. The results demonstrated superiority of the TFT
model compared to other statistical and DL-based methods,
and the significant impact of including weather information
on the accuracy and effectiveness of the forecasts. The
integration of weather data as covariates also improved the
precision of the models over higher lead times. Additionally,
the paper highlighted the efficacy of the Gaussian copula
method in restoring spatio-temporal correlations, which is
crucial for generating realistic scenarios in RES forecasting.
This methodological advancement provides a robust framework for addressing the complexities associated with highdimensional forecasting problems in RES.
Future work will focus on studying the effect of noise in
covariates on the performance of the forecasts and scenarios.
Investigating how inaccuracies in weather data influence
the modelâ€™s predictions is essential for further improving
the robustness of the forecasting method. Additionally, uncertainty quantification will be considered using conformal
prediction to provide confidence-aware predictions in highdimensional RES forecasting problems. This will involve
developing techniques to quantify and incorporate prediction
uncertainty, thereby offering more reliable and actionable
insights for system operators.



Hanyu Zhang et al.: _Preprint submitted to Elsevier_ Page 13 of 19


Probabilistic Forecasting and Scenario Generation



**References**


Akiba, T., Sano, S., Yanase, T., Ohta, T., Koyama, M., 2019. Optuna: A
Next-generation Hyperparameter Optimization Framework, in: Proceedings of the 25th ACM SIGKDD International Conference on Knowledge
Discovery & Data Mining, Association for Computing Machinery, New
York, NY, USA. p. 2623â€“2631. doi: [10.1145/3292500.3330701](http://dx.doi.org/10.1145/3292500.3330701) .
Bessa, R.J., 2016. On the quality of the gaussian copula for multi-temporal
decision-making problems, in: 2016 Power Systems Computation Conference (PSCC), IEEE. pp. 1â€“7.
BjerregÃ¥rd, M.B., MÃ¸ller, J.K., Madsen, H., 2021. An introduction to
multivariate probabilistic forecast evaluation. Energy and AI 4, 100058.
Bludszuweit, H., Dominguez-Navarro, J.A., Llombart, A., 2008. Statistical
analysis of wind power forecast error. IEEE Transactions on Power
Systems 23, 983â€“991. doi: [10.1109/TPWRS.2008.922526](http://dx.doi.org/10.1109/TPWRS.2008.922526) .
Bremnes, J.B., 2004. Probabilistic wind power forecasts using local quantile
regression. Wind Energy: An International Journal for Progress and
Applications in Wind Power Conversion Technology 7, 47â€“54.
Carmona, R., Yang, X., 2021. Glasso model for electric load and
wind power and monte carlo scenario generation. arXiv preprint
arXiv:2111.14628 .

Chakraborty, S., Zhang, X., 2021. A new framework for distance and
kernel-based metrics in high dimensions. Electronic Journal of Statistics
15, 5455â€“5522.
Chen, Y., Wang, Y., Kirschen, D., Zhang, B., 2018. Model-free renewable scenario generation using generative adversarial networks. IEEE
Transactions on Power Systems 33, 3265â€“3275. doi: [10.1109/TPWRS.](http://dx.doi.org/10.1109/TPWRS.2018.2794541)

[2018.2794541](http://dx.doi.org/10.1109/TPWRS.2018.2794541) .

Dong, D., Sheng, Z., Yang, T., 2018. Wind power prediction based on
recurrent neural network with long short-term memory units, in: 2018
International Conference on Renewable Energy and Power Engineering
(REPE), pp. 34â€“38. doi: [10.1109/REPE.2018.8657666](http://dx.doi.org/10.1109/REPE.2018.8657666) .
Dong, W., Chen, X., Yang, Q., 2022. Data-driven scenario generation
of renewable energy production based on controllable generative adversarial networks with interpretability. Applied Energy 308, 118387.
doi: [10.1016/j.apenergy.2021.118387](http://dx.doi.org/10.1016/j.apenergy.2021.118387) .
European Centre for Medium-Range Weather Forecasts, 2023. TIGGE
Data Retrieval. [https://apps.ecmwf.int/datasets/data/tigge/levtype=](https://apps.ecmwf.int/datasets/data/tigge/levtype=sfc/type=cf/)
[sfc/type=cf/](https://apps.ecmwf.int/datasets/data/tigge/levtype=sfc/type=cf/) . [Online; accessed March 2023].
Fermanian, J.D., Wegkamp, M.H., 2012. Time-dependent copulas. Journal
of Multivariate Analysis 110, 19â€“29.
Garza, F., Mergenthaler Canseco, M., ChallÃº, C., G. Olivares, K., 2022.
StatsForecast: Lightning fast forecasting with statistical and econometric
models. PyCon Salt Lake City, Utah, US 2022. URL: [https://github.](https://github.com/Nixtla/statsforecast)

[com/Nixtla/statsforecast](https://github.com/Nixtla/statsforecast) .

Gneiting, T., Raftery, A.E., 2007. Strictly proper scoring rules, prediction,
and estimation. Journal of the American statistical Association 102,

359â€“378.

Golestaneh, F., Gooi, H.B., Pinson, P., 2016. Generation and evaluation
of spaceâ€“time trajectories of photovoltaic power. Applied Energy 176,

80â€“91.

Hewamalage, H., Bergmeir, C., Bandara, K., 2021. Recurrent neural
networks for time series forecasting: Current status and future directions.
International Journal of Forecasting 37, 388â€“427.
Ho, S.L., Xie, M., 1998. The use of arima models for reliability forecasting
and analysis. Computers & industrial engineering 35, 213â€“216.
Holttinen, H., Milligan, M., Ela, E., Menemenlis, N., Dobschinski, J., Rawn,
B., Bessa, R.J., Flynn, D., Gomez-Lazaro, E., Detlefsen, N.K., 2012.
Methodologies to determine operating reserves due to increased wind
power. IEEE transactions on sustainable energy 3, 713â€“723.
Kingma, D.P., Ba, J., 2014. Adam: A method for stochastic optimization.
arXiv preprint arXiv:1412.6980 .
Knueven, B., Faqiry, M.N., Garcia, M., Chen, Y., Treinen, R., Werho, T.,
Zhang, J., Vittal, V., Zhao, L., Thatte, A., Yin, S., 2023. Stochastic
look-ahead commitment: A case study in miso, in: 2023 IEEE Power
& Energy Society General Meeting (PESGM), pp. 1â€“5. doi: [10.1109/](http://dx.doi.org/10.1109/PESGM52003.2023.10253199)

[PESGM52003.2023.10253199](http://dx.doi.org/10.1109/PESGM52003.2023.10253199) .

Koenker, R., Hallock, K.F., 2001. Quantile regression. Journal of economic
perspectives 15, 143â€“156.



Li, J., Zhou, J., Chen, B., 2020. Review of wind power scenario generation
methods for optimal operation of renewable energy systems. Applied
Energy 280, 115992. doi: [10.1016/j.apenergy.2020.115992](http://dx.doi.org/10.1016/j.apenergy.2020.115992) .
Liao, W., Yang, Z., Chen, X., Li, Y., 2022. Windgmmn: Scenario forecasting for wind power using generative moment matching networks.
IEEE Transactions on Artificial Intelligence 3, 843â€“850. doi: [10.1109/](http://dx.doi.org/10.1109/TAI.2021.3128368)

[TAI.2021.3128368](http://dx.doi.org/10.1109/TAI.2021.3128368) .
Lim, B., ArÄ±k, S.Ã–., Loeff, N., Pfister, T., 2021. Temporal fusion transformers for interpretable multi-horizon time series forecasting. International
Journal of Forecasting 37, 1748â€“1764. doi: [10.1016/j.ijforecast.2021.](http://dx.doi.org/10.1016/j.ijforecast.2021.03.012)

[03.012](http://dx.doi.org/10.1016/j.ijforecast.2021.03.012) .

Lim, B., Zohren, S., 2021. Time-series forecasting with deep learning:
a survey. Philosophical Transactions of the Royal Society A 379,

20200209.

Lu, L., Wu, H., Wu, J., 2021. A case study for the optimization of momentmatching in wind turbine blade fatigue tests with a resonant type exciting
approach. Renewable Energy 174, 769â€“785.
Ma, X.Y., Sun, Y.Z., Fang, H.L., 2013. Scenario generation of wind power
based on statistical uncertainty and variability. IEEE Transactions on
Sustainable Energy 4, 894â€“904.
Mashlakov, A., Kuronen, T., Lensu, L., Kaarna, A., Honkapuro, S., 2021.
Assessing the performance of deep learning models for multivariate
probabilistic energy forecasting. Applied Energy 285, 116405.
Messner, J.W., Pinson, P., Browell, J., BjerregÃ¥rd, M.B., Schicker, I., 2020.
Evaluation of wind power forecastsâ€”an up-to-date view. Wind Energy
23, 1461â€“1481.

NIXTLA, 2024. Autoarima model. Nixtlaverse StatsForecast Documenta
tion. URL: [https://nixtlaverse.nixtla.io/statsforecast/docs/models/](https://nixtlaverse.nixtla.io/statsforecast/docs/models/autoarima.html)

[autoarima.html](https://nixtlaverse.nixtla.io/statsforecast/docs/models/autoarima.html) . accessed: 2024-04-03.

PACE, 2017. Partnership for an Advanced Computing Environment
(PACE). URL: [http://www.pace.gatech.edu](http://www.pace.gatech.edu) .
Patton, A.J., 2006. Modelling asymmetric exchange rate dependence.
International economic review 47, 527â€“556.
Patton, A.J., 2009. Copulaâ€“based models for financial time series, in:
Handbook of financial time series. Springer, pp. 767â€“785.
Pinson, P., 2012. Very-short-term probabilistic forecasting of wind power
with generalized logitâ€“normal distributions. Journal of the Royal
Statistical Society: Series C (Applied Statistics) 61, 555â€“576.
Pinson, P., Madsen, H., Nielsen, H.A., Papaefthymiou, G., KlÃ¶ckl, B., 2009.
From probabilistic forecasts to statistical scenarios of short-term wind
power production. Wind Energy: An International Journal for Progress
and Applications in Wind Power Conversion Technology 12, 51â€“62.
Pinson, P., Nielsen, H.A., MÃ¸ller, J.K., Madsen, H., Kariniotakis, G.N.,
2007. Non-parametric probabilistic forecasts of wind power: required
properties and evaluation. Wind Energy: An International Journal for
Progress and Applications in Wind Power Conversion Technology 10,
497â€“516.

Salinas, D., Bohlke-Schneider, M., Callot, L., Medico, R., Gasthaus, J.,
2019. High-dimensional multivariate forecasting with low-rank gaussian
copula processes. Advances in neural information processing systems

32.

Salinas, D., Flunkert, V., Gasthaus, J., Januschowski, T., 2020. Deepar:
Probabilistic forecasting with autoregressive recurrent networks. International Journal of Forecasting 36, 1181â€“1191.
Saraninezhad, M., Ramezani, M., Falaghi, H., 2022. Probabilistic assessment of wind turbine impact on distribution networks by using
latin hypercube sampling method, in: 2022 9th Iranian Conference
on Renewable Energy & Distributed Generation (ICREDG), pp. 1â€“7.
doi: [10.1109/ICREDG54199.2022.9804513](http://dx.doi.org/10.1109/ICREDG54199.2022.9804513) .

Scheuerer, M., Hamill, T.M., 2015. Variogram-based proper scoring rules
for probabilistic forecasts of multivariate quantities. Monthly Weather
Review 143, 1321â€“1334.
Sergi, B., Feng, C., Zhang, F., Hodge, B.M., Ring-Jarvi, R., Bryce, R.,
Doubleday, K., Rose, M., Buster, G., Rossol, M., 2022. Arpa-e perform

datasets.

Shi, Z., Liang, H., Dinavahi, V., 2018. Direct interval forecast of uncertain
wind power based on recurrent neural networks. IEEE Transactions on
Sustainable Energy 9, 1177â€“1187. doi: [10.1109/TSTE.2017.2774195](http://dx.doi.org/10.1109/TSTE.2017.2774195) .



Hanyu Zhang et al.: _Preprint submitted to Elsevier_ Page 14 of 19


Probabilistic Forecasting and Scenario Generation



Sioshansi, R., Hurlbut, D., 2010. Market protocols in ercot and their effect
on wind generation. Energy Policy 38, 3192â€“3197.
Sklar, M., 1959. Fonctions de repartition an dimensions et leurs marges.
Publ. inst. statist. univ. Paris 8, 229â€“231.
Smyl, S., 2020. A hybrid method of exponential smoothing and recurrent
neural networks for time series forecasting. International Journal of
Forecasting 36, 75â€“85.
Srivastava, T., Vedanshu, Tripathi, M., 2020. Predictive analysis of rnn,
gbm and lstm network for short-term wind power forecasting. Journal
of Statistics and Management Systems 23, 33â€“47.
Stover, O., Karve, P., Mahadevan, S., 2023. Reliability and risk metrics to
assess operational adequacy and flexibility of power grids. Reliability
Engineering & System Safety 231, 109018. doi: [10.1016/j.ress.2022.](http://dx.doi.org/10.1016/j.ress.2022.109018)

[109018](http://dx.doi.org/10.1016/j.ress.2022.109018) .

Sutskever, I., Vinyals, O., Le, Q.V., 2014. Sequence to sequence learning
with neural networks. Advances in neural information processing
systems 27.
Tan, J., Qi, G., Sun, D., Li, W., Yang, H., Li, Z., 2020. Forecasting renewable
energy generation scenarios based on multi-agent diverse gans, in: 2020
IEEE Sustainable Power and Energy Conference (iSPEC), pp. 180â€“186.
doi: [10.1109/iSPEC50848.2020.9351117](http://dx.doi.org/10.1109/iSPEC50848.2020.9351117) .

U.S. Department of Energy, n.d.a. Renewable systems integration. [https:](https://www.energy.gov/eere/wind/renewable-systems-integration)
[//www.energy.gov/eere/wind/renewable-systems-integration](https://www.energy.gov/eere/wind/renewable-systems-integration) . Accessed:

2024-06-10.

U.S. Department of Energy, n.d.b. Windexchange: Distributed wind energy. [https://windexchange.energy.gov/markets/distributed](https://windexchange.energy.gov/markets/distributed) . Accessed:
2024-06-10.

Varela Santolalla, D., Mladek, R., 2024. Tigge archive. [https://confluence.](https://confluence.ecmwf.int/display/TIGGE)
[ecmwf.int/display/TIGGE](https://confluence.ecmwf.int/display/TIGGE) . Accessed: 2024-04-03.
Wan, C., Lin, J., Wang, J., Song, Y., Dong, Z.Y., 2017. Direct quantile
regression for nonparametric probabilistic forecasting of wind power
generation. IEEE Transactions on Power Systems 32, 2767â€“2778.
doi: [10.1109/TPWRS.2016.2625101](http://dx.doi.org/10.1109/TPWRS.2016.2625101) .

Wei, S., Xie, Y., Rahnev, D., 2021. Inferring serial correlation with dynamic backgrounds, in: International Conference on Machine Learning,
PMLR. pp. 11047â€“11057.
Wen, R., Torkkola, K., Narayanaswamy, B., Madeka, D., 2017. A multihorizon quantile recurrent forecaster. arXiv preprint arXiv:1711.11053

.

Werho, T., Zhang, J., Vittal, V., Chen, Y., Thatte, A., Zhao, L., 2021.
Scenario generation of wind farm power for real-time system operation.
arXiv preprint arXiv:2106.09105 doi: [10.48550/arXiv.2106.09105](http://dx.doi.org/10.48550/arXiv.2106.09105) .
Wilms, H., Cupelli, M., Monti, A., Gross, T., 2019. Exploiting spatiotemporal dependencies for rnn-based wind power forecasts, in: 2019
IEEE PES GTD Grand International Conference and Exposition Asia
(GTD Asia), pp. 921â€“926. doi: [10.1109/GTDAsia.2019.8715887](http://dx.doi.org/10.1109/GTDAsia.2019.8715887) .
Zeng, A., Chen, M., Zhang, L., Xu, Q., 2022. Are transformers effective for
time series forecasting? arXiv preprint arXiv:2205.13504 .
Zhang, Y., Ai, Q., Xiao, F., Hao, R., Lu, T., 2020. Typical wind power
scenario generation for multiple wind farms using conditional improved
wasserstein generative adversarial network. International Journal of
Electrical Power & Energy Systems 114, 105388. doi: [10.1016/j.ijepes.](http://dx.doi.org/10.1016/j.ijepes.2019.105388)

[2019.105388](http://dx.doi.org/10.1016/j.ijepes.2019.105388) .


**A. Evaluation Metrics**


In this section, the details of evaluation metrics are
provided.


**A.1. Deterministic Forecast**

In the case of point forecast, _ğ‘†_ = 1 and only one
scenario/forecast is generated. For notational simplicity, the
scenario index _ğ‘ _ is dropped in this subsection.


_Normalized Mean Absolute Error (NMAE)_ For wind
and solar power, the ground truth can sometimes become



zero or close to zero. To avoid dividing by zeros, NMAE is
considered. The first metric considers the forecast on each
space-time dimension:



_,_ (13)
|||||



1
NMAE ind = _ğ‘_ test _ğ·ğ‘‡_



_ğ‘_ test
âˆ‘ âˆ‘

_ğ‘¡_ =1 _ğ‘–_ âˆˆîˆ° _,ğœ_ âˆˆîˆ´



|||||



_Ì‚ğ‘§_ _ğ‘–,ğœ_ âˆ’ _ğ‘§_ _ğ‘–,ğœ_
max{ **ğ³** _ğ‘–,_ î‰€ train }



expressed as a percentage. The NMAE ind reflects the average
performance on individual time series.
The normalization value _ğ‘§_ max{ **ğ³** _ğ‘–,_ î‰€ } is the capacity of the
generator if given. If the capacity is not given, it is the
maximum value of the first year in the training dataset.
The second metric considers summation over space and
is defined as:



_ğ‘§_ _ğ‘–,ğœ_
_ğ‘–_ =1



_ğ·_ _ğ·_
âˆ‘ _Ì‚ğ‘§_ _ğ‘–,ğœ_ âˆ’ âˆ‘

_ğ‘–_ =1 _ğ‘–_ =1



_ğ·_
âˆ‘



_ğ·_
âˆ‘ max{ **ğ³** _ğ‘–,_ î‰€ train }

_ğ‘–_ =1



||||||||||



_._ (14)



||||||||||



1
NMAE s-sum = _ğ‘_ test _ğ‘‡_



_ğ‘_ test
âˆ‘ âˆ‘

_ğ‘¡_ =1 _ğœ_ âˆˆîˆ´



_Root Mean Square Error (RMSE)_ The RMSE is a commonly used metric to measure the accuracy of a model by
calculating the square root of the average squared differences
between the predicted and actual values. It provides a measure of the average magnitude of the error. The first metric
considers the forecast on each space-time dimension:



âˆ‘

_ğ‘–_ âˆˆîˆ° _,ğœ_ âˆˆîˆ´



2
( _Ì‚ğ‘§_ _ğ‘–,ğœ_ âˆ’ _ğ‘§_ _ğ‘–,ğœ_ ) _,_ (15)



RMSE ind =



âˆš
âˆš
âˆš 1
âˆš
_ğ‘_ test _ğ·ğ‘‡_
âˆš



_ğ‘_ test
âˆ‘

_ğ‘¡_ =1



expressed in megawatts (MW). The RMSE ind reflects the
average performance on individual dimension.
The second metric considers summation over space and
is defined as:



2


_,_

)



_ğ·_


_Ì‚ğ‘§_ âˆ’

âˆ‘ _ğ‘–,ğœ_
( _ğ‘–_ =1



_ğ·_
âˆ‘ _ğ‘§_ _ğ‘–,ğœ_

_ğ‘–_ =1



RMSE s-sum =



~~âˆš~~
~~âˆš~~
âˆšâˆš 1
_ğ‘_ test _ğ‘‡_
âˆš



_ğ‘_ test
âˆ‘

_ğ‘¡_ =1



âˆ‘

_ğœ_ âˆˆîˆ´



(16)


also expressed in MW. The RMSE s-sum measures the modelâ€™s
accuracy in predicting the summation of wind power, solar
power, or load over space.


**A.2. Probabilistic Forecast**

_Energy Distance_ The energy distance is a popular metric
for evaluating the quality of probabilistic forecasts (Messner,
Pinson, Browell, BjerregÃ¥rd and Schicker, 2020). Given two
probability distributions îˆ² and îˆ³ with support in â„ _[ğ·]_, the
energy distance between îˆ² and îˆ³ is defined as


ED(îˆ² _,_ îˆ³) = 2ğ”¼ â€– _ğ‘‹_ âˆ’ _ğ‘Œ_ â€–âˆ’ğ”¼ [â€–] â€– _ğ‘‹_ âˆ’ _ğ‘‹_ [â€²] [â€–] â€–âˆ’ğ”¼ [â€–] â€– _ğ‘Œ_ âˆ’ _ğ‘Œ_ [â€²] [â€–] â€– _,_ (17)


where â€– â‹… â€– is the Euclidean norm, and _ğ‘‹_ âˆ¼ îˆ² _, ğ‘‹_ [â€²] âˆ¼ îˆ² _, ğ‘Œ_ âˆ¼
îˆ³ _, ğ‘Œ_ [â€²] âˆ¼ îˆ³ are independent random variables. In particular,
when îˆ² and îˆ³ are empirical probability distributions with



Hanyu Zhang et al.: _Preprint submitted to Elsevier_ Page 15 of 19


Probabilistic Forecasting and Scenario Generation



realizations **ğ±** = { _ğ‘¥_ 1 _, ..., ğ‘¥_ _ğ‘›_ } and **ğ²** = { _ğ‘¦_ 1 _, ..., ğ‘¦_ _ğ‘š_ }, an
estimator of the energy distance using the U-statistics is
given by:



_Variogram Score_ The variogram score (VS) captures the
correlations among multivariate quantities (Scheuerer and
Hamill, 2015). Given a probabilistic forecast at time _ğ‘¡_, the
corresponding variogram score of order _ğ‘_ is defined as



_ğ‘š_
âˆ‘ â€– _ğ‘¥_ _ğ‘–_ âˆ’ _ğ‘¦_ _ğ‘—_ â€–

_ğ‘—_ =1



VS _ğ‘_ ( _ğ‘¡_ ) =



ED _Ì‚_ ( **ğ±** _,_ **ğ²** ) = [2]

_ğ‘šğ‘›_



_ğ‘›_
âˆ‘

_ğ‘–_ =1



âˆ‘

_ğœ_ 1 âˆˆî‰€



âˆ‘

_ğœ_ 2 âˆˆî‰€



_ğ‘_

( ||| _ğ‘§_ _ğ‘–,ğœ_ 1 âˆ’ _ğ‘§_ _ğ‘—,ğœ_ 2 |||



(20)



_ğ·_ _ğ·_
âˆ‘ âˆ‘

_ğ‘–_ =1 _ğ‘—_ =1



_ğ‘š_ [2]



_ğ‘š_
âˆ‘ â€– _ğ‘¦_ _ğ‘–_ âˆ’ _ğ‘¦_ _ğ‘—_ â€– _._

_ğ‘—_ =1



âˆ’ [1]

_ğ‘†_



( _ğ‘ _ ) _ğ‘_
||| _Ì‚ğ‘§_ _ğ‘–,ğœ_ 1 [âˆ’] _[Ì‚ğ‘§]_ _ğ‘—,ğœ_ [(] _[ğ‘ ]_ [)] 2 ||| ) _._



âˆ’ [1]

_ğ‘›_ [2]



_ğ‘›_
âˆ‘

_ğ‘–_ =1



_ğ‘›_
âˆ‘



âˆ‘ â€– _ğ‘¥_ _ğ‘–_ âˆ’ _ğ‘¥_ _ğ‘—_ â€– âˆ’ [1]

_ğ‘š_ [2]

_ğ‘—_ =1



_ğ‘š_
âˆ‘

_ğ‘–_ =1



_ğ‘†_
âˆ‘

_ğ‘ _ =1



(18)


Note that, for _ğ‘š_ = 1 case, the third term in the above

summation is zero.

Here, two energy distance metrics are considered: (i)
At time step _ğ‘¡_, the _ğ·_ -by- _ğ‘‡_ matrix _ğ‘§_ â‹… _,_ îˆ´ is vectorized by
stacking the columns of the matrix on top of one another. The
resulting _ğ·ğ‘‡_ -dimensional vector is denoted by vec( _ğ‘§_ â‹… _,_ îˆ´ ).
There arequality of those forecasts are measured by _ğ‘†_ generated forecasts, _Ì‚ğ‘§_ [(] â‹… _,_ _[ğ‘ ]_ îˆ´ [)] _[, ğ‘ ]_ [= 1] _[,]_ [ â€¦] _[, ğ‘†]_ [and the]


ED _Ì‚_ (vec( _ğ‘§_ â‹… _,_ îˆ´ ) _,_ {vec( _Ì‚ğ‘§_ â‹… _,_ îˆ´ ) [(] _[ğ‘ ]_ [)] _, ğ‘ _ = 1 _,_ â€¦ _, ğ‘†_ })



In all the experiments that follow, the variogram score is
evaluated with _ğ‘_ = 0 _._ 5, following the recommendations in
Scheuerer and Hamill (2015).
As can be seen from Eq (20), computing the variogram
score for one time period has complexity îˆ»( _ğ·_ [2] _ğ‘‡_ [2] _ğ‘†_ ). This
is computationally intractable for high dimensional setting,
where _ğ·_ â‰¥ 300, _ğ‘‡_ = 48, and _ğ‘†_ = 200 for two days
ahead solar power forecast. Therefore, variogram scores are
reported for summation of load and renewable generation
predictions over space. This captures temporal correlations
(between time periods), at the expense of spatial correlations
(between time series).



= [2]

_ğ‘†_



_ğ‘†_
âˆ‘

_ğ‘ _ =1



â€–â€–â€– _ğ‘§_ â‹… _,_ îˆ´ âˆ’ _Ì‚ğ‘§_ (â‹… _,ğ‘ _ îˆ´) â€–â€–â€– _ğ¹_



VS _ğ‘,_ s-sum ( _ğ‘¡_ ) = âˆ‘

_ğœ_ 1 âˆˆî‰€



_ğ‘§_ _ğ‘–,ğœ_ 1 âˆ’
_ğ‘–_ =1



(21)



âˆ’ [1]

_ğ‘†_ [2]



_ğ‘†_
âˆ‘ â€–â€–â€– _Ì‚ğ‘§_ (â‹… _,ğ‘ _ îˆ´ 1 ) [âˆ’] _[Ì‚ğ‘§]_ â‹… [(] _,_ _[ğ‘ ]_ îˆ´ [2] [)] â€–â€–â€– _ğ¹_ _,_

_ğ‘ _ 1 _,ğ‘ _ 2 =1



|||||| _ğ‘_



âˆ‘

_ğœ_ 2 âˆˆî‰€



( ||||||



_ğ·_
âˆ‘



_ğ·_
âˆ‘ _ğ‘§_ _ğ‘–,ğœ_ 2

_ğ‘–_ =1



where â€– â‹… â€– _ğ¹_ denotes the matrix _ğ¹_ -norm and â€– vec(â‹…)â€– =
â€– â‹… â€– _ğ¹_ . In the following experiments, given _ğ‘ğ‘†_ probabilistic
forecasts produced, the average over _ğ‘¡_ = 1 _,_ â€¦ _, ğ‘_ is taken as
the first metric, which is also called the energy score



||||||



_ğ·_

_Ì‚ğ‘§_ [(] _[ğ‘ ]_ [)]

âˆ‘ _ğ‘–,ğœ_ 1 [âˆ’]

_ğ‘–_ =1



_ğ‘_ [)]


_._

||||||



_ğ‘_ [)]


_._



_ğ·_

_Ì‚ğ‘§_ [(] _[ğ‘ ]_ [)]

âˆ‘ _ğ‘–,ğœ_ 2

_ğ‘–_ =1



âˆ’ [1]

_ğ‘†_



_ğ‘†_
âˆ‘

_ğ‘ _ =1



_._



1
ED ind = _ğ‘_ test



âˆ‘

_ğ‘¡_ âˆˆîˆº test



ED _Ì‚_ (vec( _ğ‘§_ â‹… _,_ îˆ´ ) _,_ {vec( _Ì‚ğ‘§_ â‹… _,_ îˆ´ ) [(] _[ğ‘ ]_ [)] _, ğ‘ _ = 1 _,_ â€¦ _, ğ‘†_ }) _._


(19)



Averaging over the test set, the average space-sum variogram score is given as



1
VS s-sum = _ğ‘_ test



_ğ‘_ test
âˆ‘ VS _ğ‘,_ s-sum ( _ğ‘¡_ ) _._ (22)

_ğ‘¡_ =1



(ii) The energy distance computed on space-sum level is
given by


ED _Ì‚_ ( **ğŸ** [T] _ğ‘§_ â‹… _,_ îˆ´ _,_ { **ğŸ** [T] _Ì‚ğ‘§_ [(] â‹… _,_ _[ğ‘ ]_ îˆ´ [)] _[, ğ‘ ]_ [= 1] _[,]_ [ â€¦] _[, ğ‘†]_ [})]



Another metric inter-changes the order of the summation
and is defined as follows:



= [2]

_ğ‘†_



_ğ‘†_
âˆ‘

_ğ‘ _ =1



â€–â€–â€– **ğŸ** T _ğ‘§_ â‹… _,_ îˆ´ âˆ’ **ğŸ** T _Ì‚ğ‘§_ (â‹… _,ğ‘ _ îˆ´) â€–â€–â€–



(23)



( [|]
|||||



|||||| _ğ‘_



_ğ‘§_ _ğ‘—,ğœ_
_ğœ_ âˆˆî‰€



_ğ·_ _ğ·_
âˆ‘ âˆ‘

_ğ‘–_ =1 _ğ‘—_ =1



âˆ‘ _ğ‘§_ _ğ‘–,ğœ_ âˆ’ âˆ‘

_ğœ_ âˆˆî‰€ _ğœ_ âˆˆî‰€



âˆ‘



VS _ğ‘,_ t-sum ( _ğ‘¡_ ) =



âˆ‘



âˆ’ [1]

_ğ‘†_ [2]



_ğ‘†_
âˆ‘ â€–â€–â€– **ğŸ** T _Ì‚ğ‘§_ (â‹… _,ğ‘ _ îˆ´ 1 ) [âˆ’] **[ğŸ]** [T] _[ Ì‚ğ‘§]_ [(] â‹… _,_ _[ğ‘ ]_ îˆ´ [2] [)] â€–â€–â€– _._

_ğ‘ _ 1 _,ğ‘ _ 2 =1



||||||



_Ì‚ğ‘§_ [(] _[ğ‘ ]_ [)]

âˆ‘ _ğ‘–,ğœ_ [âˆ’] âˆ‘

_ğœ_ âˆˆî‰€ _ğœ_ âˆˆî‰€



_ğ‘†_
âˆ‘

_ğ‘ _ =1



_ğ‘_

_._
)

||||||



âˆ‘ _Ì‚ğ‘§_ [(] _ğ‘—,ğœ_ _[ğ‘ ]_ [)]

_ğœ_ âˆˆî‰€



The second metric, referred to as average space-sum energy

score:



âˆ’ [1]

_ğ‘†_



1
ED s-sum = _ğ‘_ test



âˆ‘

_ğ‘¡_ âˆˆîˆº test



ED _Ì‚_ ( **ğŸ** [T] _ğ‘§_ â‹… _,_ îˆ´ _,_ { **ğŸ** [T] _Ì‚ğ‘§_ â‹… _,_ îˆ´ ( _ğ‘ _ ) _, ğ‘ _ = 1 _,_ â€¦ _, ğ‘†_ })



Averaging over the test set, the average time-sum variogram score is given as



_ğ‘_ test
âˆ‘ VS _ğ‘,_ t-sum ( _ğ‘¡_ ) _._ (24)

_ğ‘¡_ =1



Recall that forecasts are produced for multiple time
series and time periods. Therefore, the energy distance in
Eq. (19) captures both the spatial and temporal quality of
the forecasts.



1
VS t-sum = _ğ‘_ test



Hanyu Zhang et al.: _Preprint submitted to Elsevier_ Page 16 of 19


Probabilistic Forecasting and Scenario Generation



**A.3. Marginal Distributions**
When estimating marginal distributions, researchers
typically employ either parametric or non-parametric approaches. This section introduces two prevalent methods:
quantile regression and parameterized distribution estimation.


_Non-Parametric Estimation: Quantile Regression_ The
quantile regression approach, as outlined in Wen et al.(Wen
et al., 2017), utilizes the concept of quantile loss in multistep
multivariate settings. Consider îˆ½ to represent a predefined
set of quantiles. For any given target quantity in space-time,
denoted by _ğ‘§_ _ğ‘–,ğœ_, our model generates a corresponding set
of quantile estimates _Ì‚ğ‘§_ [(] _ğ‘–,ğœ_ _[ğ‘]_ [)] [, where] _[ ğ‘]_ [âˆˆ] [îˆ½][. The primary goal]
is to minimize the overall quantile loss function across all
estimated quantiles, _Ì‚ğ‘§_ [(] _ğ‘–,ğœ_ _[ğ‘]_ [)] [, formulated as follows:]



Optimization is typically performed on the log-likelihood,



âˆ‘

_ğœ_ âˆˆîˆ´



âˆ‘[( _ğ›¼_ _ğ‘–,ğœ_ âˆ’1) ln( _ğ‘§_ _ğ‘–,ğœ_ ) + ( _ğ›½_ _ğ‘–,ğœ_ âˆ’1) ln(1 âˆ’ _ğ‘§_ _ğ‘–,ğœ_ )]

_ğ‘–_ âˆˆîˆ°



max
_ğ›¼_ _ğ‘–,ğœ_ _,ğ›½_ _ğ‘–,ğœ_



âˆ‘

_ğ‘¡_



min âˆ‘

_ğ‘¡_



âˆ‘

_ğœ_ âˆˆîˆ´



âˆ‘

_ğ‘_ âˆˆîˆ½



âˆ‘ QL _ğ‘_ ( _ğ‘§_ _ğ‘–,ğœ_ _, Ì‚ğ‘§_ [(] _ğ‘–,ğœ_ _[ğ‘]_ [)] ) _,_

_ğ‘–_ âˆˆîˆ°



where _ğ‘¡_ iterates over all forecast creation times.
The quantile loss (QL) is defined as


QL _ğ‘_ ( _ğ‘§_ _ğ‘–,ğœ_ _, Ì‚ğ‘§_ [(] _ğ‘–,ğœ_ _[ğ‘]_ [)] )

+ + (25)
= _ğ‘_ ( _ğ‘§_ _ğ‘–,ğœ_ âˆ’ _Ì‚ğ‘§_ _ğ‘–,ğœ_ [(] _[ğ‘]_ [)] ) + (1 âˆ’ _ğ‘_ ) ( _Ì‚ğ‘§_ [(] _ğ‘–,ğœ_ _[ğ‘]_ [)] [âˆ’] _[ğ‘§]_ _[ğ‘–,ğœ]_ ) _,_


where (â‹…) [+] = max(0 _,_ â‹…). This paper considers the quantiles
_ğ‘_ âˆˆ{0 _._ 1 _,_ 0 _._ 3 _,_ 0 _._ 5 _,_ 0 _._ 7 _,_ 0 _._ 9}.
Once the quantiles _Ì‚ğ‘§_ [(] _ğ‘–,ğœ_ _[ğ‘]_ [)] [are available, the CDF function]
_Ì‚ğ¹_ _ğ‘–,ğœ_ ( _ğ‘§_ _ğ‘–,ğœ_ ) can be estimated from fitting a smooth curve across
the predicted quantiles.


_Parametric Estimation: Maximum Likelihood Estima-_
_tion (MLE)_ The Beta MLE approach is utilized for estimating the parameters of a Beta distribution, typically denoted
as _ğ›¼_ (alpha) and _ğ›½_ (beta). This method is particularly beneficial when the data is understood to follow a Beta distribution,
often applicable to variables constrained between 0 and 1.
For RES, it is common to scale the time series based on
their capacity to capacity factors, therefore, beta distribution
is chosen to demonstrate the parametric estimation.
For a set of observations _ğ‘§_ _ğ‘–,ğœ_ corresponding to each
forecast time _ğœ_ within the forecast horizon îˆ´ and across all

dimensions _ğ‘–_ âˆˆ îˆ°, assuming these observations are drawn
from a Beta distribution, the aim of Beta MLE is to find the
parameter values that maximize the likelihood of the given
sample.
The likelihood function for the Beta distribution, given
the observations, is:



âˆ

_ğœ_ âˆˆîˆ´



âˆ

_ğ‘–_ âˆˆîˆ°



_ğ›¼_ _ğ‘–,ğœ_ âˆ’1
_ğ‘§_ _ğ‘–,ğœ_ (1 âˆ’ _ğ‘§_ _ğ‘–,ğœ_ ) _[ğ›½]_ _[ğ‘–,ğœ]_ [âˆ’1]

_ğµ_ ( _ğ›¼_ _ğ‘–,ğœ_ _, ğ›½_ _ğ‘–,ğœ_ ) _,_



max
_ğ›¼_ _ğ‘–,ğœ_ _,ğ›½_ _ğ‘–,ğœ_



âˆ

_ğ‘¡_



where _ğ‘¡_ iterates all forecast creation times and _ğµ_ ( _ğ›¼_ _ğ‘–,ğœ_ _, ğ›½_ _ğ‘–,ğœ_ )
is the Beta function.



âˆ’ _ğ·ğ»_ ln( _ğµ_ ( _ğ›¼_ _ğ‘–,ğœ_ _, ğ›½_ _ğ‘–,ğœ_ )) _._
(26)


The _Ì‚ğ›¼_ _ğ‘–,ğœ_ and _ğ›½_ _[Ì‚]_ _ğ‘–,ğœ_ are found using gradient decent. Then
the estimated marginal CDF functions can be written as
_Ì‚ğ¹_ _ğ‘–,ğœ_ ( _ğ‘§_ _ğ‘–,ğœ_ ) = _ğ¼_ _ğ‘§_ _ğ‘–,ğœ_ ( _ğ›¼_ _ğ‘–,ğœ_ _ğ›½_ _ğ‘–,ğœ_ ) where _ğ¼_ _ğ‘§_ _ğ‘–,ğœ_ ( _ğ›¼_ _ğ‘–,ğœ_ _ğ›½_ _ğ‘–,ğœ_ ) is the regularized incomplete beta function.


**B. Baseline Models**


**B.1. Autoregressive Integrated Moving Average**
**(ARIMA)**
The ARIMA model is a popular and widely used statistical method for time series forecasting. It combines the concepts of autoregressive (AR), differencing (I), and moving
average (MA) models to forecast future values based on past
values. The AR component considers the linear relationship
between an observation and a certain number of lagged observations. The I component involves differencing the series
to make it stationary, removing trends or seasonality that
can affect the model. However, the non-stationarity can be
sometimes caused by a non-structured dynamic background
(Wei, Xie and Rahnev, 2021); The method proposed therein
can only handle time series retrospectively, and fails to
forecast the dynamic background. The unstructured nonstationarity is out of the scope of the current work and is
left for future discussion. The MA component accounts for
the linear dependency between an observation and a residual
error from a moving average model applied to lagged observations.

The ARIMA model is a univariate model. The multi
varite extention of ARIMA model is the Vector Autore
gressive Integrated Moving Average (VARIMA) model.
VARIMA models capture the dependencies between the
lagged values of all the variables in the system. However,
in the high-dimensional time series problem. The VARIMA
model is unsuitable in practice because of the number
of parameters in the linear model. Therefore, each time
series is modeled independently using ARIMA model using the existing Auto-ARIMA package (Garza, Mergenthaler Canseco, ChallÃº and G. Olivares, 2022).


**B.2. DeepAR**
DeepAR model is a deep learning-based approach that
uses RNNs to capture temporal dependencies and can handle
multiple related time series together. Similar to ARIMA
model, DeepAR deals with multi-step ahead forecast by
applying the model recursively, utilizing its own predictions
as inputs for future predictions. As shown in Figure 5, the
model takes observations prior to time _ğ‘¡_ as input, and its
predictions for the prediction horizon starting at time _ğ‘¡_ are
used as inputs for the model at the next time step. The



Hanyu Zhang et al.: _Preprint submitted to Elsevier_ Page 17 of 19


Probabilistic Forecasting and Scenario Generation


where


_ğµ_ ( _ğ›¼, ğ›½_ ) = [Î“][(] _[ğ›¼]_ [)][Î“][(] _[ğ›½]_ [)] (29)

Î“( _ğ›¼_ + _ğ›½_ ) _[,]_


and Î“(â‹…) is the Gamma function. In this beta distribution
example, at time _ğ‘¡_, the model estimation can be done by
maximizing the log-likelihood as follows:



âˆ‘ log ğ“ ( _ğ‘§_ [(] _ğ‘–,ğœ_ _[ğ‘¡]_ [)] [;] _[ ğ›¼]_ _ğ‘–,ğœ_ [(] _[ğ‘¡]_ [)] _[, ğ›½]_ _ğ‘–,ğœ_ [(] _[ğ‘¡]_ [)] ) _,_

_ğ‘–_ âˆˆîˆ° _,ğœ_ âˆˆîˆ´



1
max
**ğš¯** ( _ğ‘_ âˆ’ _ğ‘Š_ âˆ’ _ğ»_ ) _ğ»ğ·_


with _ğœƒ_ ( **ğ¡** [(] _ğ‘–,ğ‘¡_ _[ğ‘¡]_ [)] [; Î˜) =] ( _ğ›¼_ _ğ‘–,ğœ_ [(] _[ğ‘¡]_ [)] _[, ğ›½]_ _ğ‘–,ğœ_ [(] _[ğ‘¡]_ [)] ) _._



_ğ‘_ âˆ’ _ğ»_
âˆ‘

_ğ‘¡_ = _ğ‘Š_



**Figure 5:** DeepAR


modelâ€™s outputs are the parameters of a beta distribution,
_ğ›¼_ and _ğ›½_, rather than a Gaussian distribution as used in the
original paper. This is because the DeepAR model outputs
capacity factors of RES that are bounded between 0 and 1,
making the Gaussian distribution unsuitable.
To estimate the model likelihood, the joint conditional
distribution of _ğ‘_ â‹… _,_ î‰€ can be decomposed into a product of
marginal conditional probabilistic distributions via Bayes
rule as follows:



_ğ‘_ âˆ’ _ğ»_
âˆ

_ğ‘¡_ = _ğ‘Š_



âˆ _ğ¹_ _ğ‘–,ğœ_ [(] _[ğ‘¡]_ [)] ( _ğ‘§_ [(] _ğ‘–,ğœ_ _[ğ‘¡]_ [)] [âˆ£] **[ğ³]** â‹… [(] _,_ _[ğ‘¡]_ î‰ƒ [)] _[,]_ **[ ğ±]** â‹… [(] _,_ _[ğ‘¡]_ î‰ƒ [)] _[,]_ **[ ğ±]** â‹… [(] _,_ _[ğ‘¡]_ îˆ´ [)]

_ğ‘–_ âˆˆîˆ° _,ğœ_ âˆˆîˆ´



**B.3. NLinear and DLinear**


**Figure 6:** Linear Model


The NLinear and Dlinear models are variants of the

model described in Zeng et al. (2022). The original paper
does not consider the spatial correlations and covariates.
And the weights are shared for every time series. To account
for covariates (weather forecast), every future dimension in
space and time is regressed on features of all past observations for all time series as well as covariates that extends to

future.

Figure 6 provides a visual representation of the models
inputs and outputs for a vanilla linear (one-layer) model.
Dlinear and Nlinear correspond to two preprocessing methods build upon the vanilla linear model. Dlinear uses decomposition scheme, which decomposes the input into trend
and seasonal component. NLinear normalizes each input by
subtracting the last value in the sequence, and then adds
it back after passing through the linear layer to address
distribution shift. Initially, the models were only used for
point predictions. However, in this paper, it is adapted to
a probabilistic setting by using quantile regression as the
objective function, as described in the TFT (Lim et al., 2021)
model.


**B.4. Temporal Fusion Transformer (TFT)**
TFT is a deep learning model designed for multi-horizon
forecasting tasks with mixed-type inputs, including static
covariates, known future inputs, and past exogenous time
series. TFT uses a combination of recurrent layers and selfattention layers to learn temporal relationships at different
scales and provide interpretable insights into temporal dynamics. The model utilizes specialized components to select
relevant features and gating layers to suppress unnecessary



_._ (27)
)



The marginal conditional distribution takes the following form



_ğ¹_ _ğ‘–,ğœ_ [(] _[ğ‘¡]_ [)] ( _ğ‘§_ _ğ‘–,ğœ_ [(] _[ğ‘¡]_ [)] [âˆ£] **[ğ³]** â‹… [(] _,_ _[ğ‘¡]_ î‰ƒ [)] _[,]_ **[ ğ³]** â‹… [(] _,_ _[ğ‘¡]_ î‰ƒ [)] _[,]_ **[ ğ±]** â‹… [(] _,_ _[ğ‘¡]_ îˆ´ [)]



) = ğ“ ( _ğ‘§_ [(] _ğ‘–,ğœ_ _[ğ‘¡]_ [)] [âˆ£] _[ğœƒ]_ [(] **[ğ¡]** [(] _ğ‘–,ğ‘¡_ _[ğ‘¡]_ [)] [; Î˜)] ) _,_



where the likelihood ğ“(â‹…) is parameterized by _ğœƒ_, where _ğœƒ_
depends on trainable parameter Î˜ and the output **ğ¡** [(] _ğ‘–,ğ‘¡_ _[ğ‘¡]_ [)] [of an]
autoregressive RNN:


**ğ¡** [(] _ğ‘–,ğ‘¡_ _[ğ‘ ]_ [)] [=] _[ â„]_ ( **ğ¡** _ğ‘–,ğ‘¡_ [(] _[ğ‘¡]_ [)] âˆ’1 _[,]_ **[ ğ³]** â‹… [(] _,_ _[ğ‘¡]_ î‰ƒ [)] _[,]_ **[ ğ³]** â‹… [(] _,_ _[ğ‘¡]_ î‰ƒ [)] _[,]_ **[ ğ±]** â‹… [(] _,_ _[ğ‘¡]_ îˆ´ [)] [; Î˜] ) _,_ (28)


and _â„_ (â‹…) is a multi-layer RNN with LSTM cells. Here,
Î˜ are typically associated with the neural network model
architecture. This model is autoregressive in the sense that
it exploits the observation at the last step _ğ‘§_ _ğ‘–,ğ‘¡_ âˆ’1 and the
previous output of the network **ğ¡** [(] _ğ‘–,ğ‘¡_ _[ğ‘¡]_ [)] âˆ’1 [as an input at the next]
time step.
In our work, because the amount of electricity generated
by the wind farm is capped by the wind power capacity
per wind farm, by normalizing with respect to the wind
power capacity, the historical wind power time series can
be represented within the range of [0 _,_ 1]. Thus, the beta
distribution for the target parametric distribution is more
suitable. The likelihood of the beta distribution reads


ğ“( _ğ‘§_ ; _ğ›¼, ğ›½_ ) = _[ğ‘§]_ _[ğ›¼]_ [âˆ’1] [(][1 âˆ’] _[ğ‘§]_ [)] _[ğ›½]_ [âˆ’1] _,_

_ğµ_ ( _ğ›¼, ğ›½_ )



Hanyu Zhang et al.: _Preprint submitted to Elsevier_ Page 18 of 19


Probabilistic Forecasting and Scenario Generation


**Figure 7:** Temporal Fusion Transformer (TFT)



components, resulting in high performance in a wide range
of scenarios. Figure 7 presents an illustration of TFT (Lim
et al., 2021) architecture.
TFT models output prediction intervals via a quantile regression approach. For a chosen set of quantiles îˆ½
with |îˆ½| = _ğ‘„_, the TFT model outputs forecast quantiles
_Ì‚ğ‘§_ [(] _[ğ‘¡]_ [)]
_ğ‘–,ğœ_ [(] _[ğ‘]_ [)] _[, ğ‘]_ [âˆˆ] [îˆ½][. The objective is to minimize the quantile]

loss function with respect to all quantile outputs _Ì‚ğ‘§_ [(] _ğ‘–,ğœ_ _[ğ‘¡]_ [)] [(] _[ğ‘]_ [)][â€™s,]
i.e.,



**Model** **Parameter** **Load** **Solar** **Wind**



WI-DeepAR



in_len 22 24 23
hidden_dim 256 191 234
n_rnn_layers 1 1 1
dropout 0.2635 0.3275 0.1677
lr 0.000825 0.003539 0.003172



in_len 12 8 4
WI-DLinear kernel_size 10 7 2
lr 0.000097 0.000063 0.000177

WI-NLinear in_len 10 6 1
lr 0.000126 0.000084 0.000218



in_len 22 14 11
hidden_size 45 101 118
num_attention_heads 3 4 2
hidden_continuous_size 87 39 40
lstm_layers 2 2 2
dropout 0.23 0.21 0.36
lr 0.0073 0.0022 0.0032



âˆ‘

_ğ‘–_ âˆˆîˆ° _,ğœ_ âˆˆîˆ´



WI-TFT



1
min
( _ğ‘_ âˆ’ _ğ‘Š_ âˆ’ _ğ»_ ) _ğ»ğ·_


where


QL ( _ğ‘§_ [(] _ğ‘–,ğœ_ _[ğ‘ ]_ [)] _[, Ì‚ğ‘§]_ _ğ‘–,ğœ_ [(] _[ğ‘ ]_ [)] [(] _[ğ‘]_ [)] )



_ğ‘_ âˆ’ _ğ»_
âˆ‘

_ğ‘¡_ = _ğ‘Š_



âˆ‘ QL ( _ğ‘§_ [(] _ğ‘–,ğœ_ _[ğ‘¡]_ [)] _[, Ì‚ğ‘§]_ _ğ‘–,ğœ_ [(] _[ğ‘¡]_ [)] [(] _[ğ‘]_ [)] ) _,_

_ğ‘_ âˆˆîˆ½



+ +
= _ğ‘_ ( _ğ‘§_ [(] _ğ‘–,ğœ_ _[ğ‘ ]_ [)] [âˆ’] _[Ì‚ğ‘§]_ _ğ‘–,ğœ_ [(] _[ğ‘ ]_ [)] [(] _[ğ‘]_ [)] ) + (1 âˆ’ _ğ‘_ ) ( _Ì‚ğ‘§_ [(] _ğ‘–,ğœ_ _[ğ‘ ]_ [)] [(] _[ğ‘]_ [) âˆ’] _[ğ‘§]_ _ğ‘–,ğœ_ [(] _[ğ‘ ]_ [)] ) _,_


and (â‹…) [+] = max(0 _,_ â‹…). All experiments use values of
_ğ‘_ âˆˆ{0 _._ 1 _,_ 0 _._ 3 _,_ 0 _._ 5 _,_ 0 _._ 7 _,_ 0 _._ 9}. In the inference phase, scenarios
are sampled by first generating uniformly-distributed noised
in [0 _,_ 1], then by applying the inverse CDF defined by the
quantiles produced by the TFT model.


**C. Training Process**


The models were trained using the Adam optimizer, and
a learning rate scheduler was employed to adaptively adjust
the learning rate during training. Specifically, we utilized the
ReduceLROnPlateau scheduler with a reduction factor of 0.1, a
threshold of 0.0001, a patience of 5 epochs, and a minimum
learning rate of lr Ã— 10 [âˆ’4] . Early stopping criteria were also
implemented based on the validation loss, with a patience
of 10 epochs and a minimum delta of 0.0001 to prevent
overfitting. The detailed configurations of each model are
provided in Table 7. All experiments were conducted on a



**Table 7**

Model configurations for load, solar, and wind


single node equipped with one NVIDIA A100 GPU using
the PACE cluster infrastructure PACE (2017).



Hanyu Zhang et al.: _Preprint submitted to Elsevier_ Page 19 of 19


